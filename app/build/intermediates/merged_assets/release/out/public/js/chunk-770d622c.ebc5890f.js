(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-770d622c"],{c7512:function(e,i,t){"use strict";t.r(i);var a=t("7a23");function n(e,i,t,n,o,s){const r=Object(a["resolveComponent"])("his-standard-form");return Object(a["openBlock"])(),Object(a["createBlock"])(r,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit},null,8,["cancelDestinationPath","fields","onFinishAction"])}var o=t("9441"),s=t("7365"),r=t("cc6f");class l extends r["a"]{constructor(e,i){super(e,104,i)}}var c=t("2706"),d=t("d95e"),u=t("e86e"),p=t("b5e4"),v=t("23e6");const b=28;var h=t("3800"),f=Object(a["defineComponent"])({components:{HisStandardForm:o["a"]},mixins:[s["a"]],data:()=>({registrationService:{}}),watch:{ready:{async handler(e){e&&(this.registrationService=new l(this.patient.getID(),this.providerID),this.fields=this.getFields())},immediate:!0,deep:!0}},methods:{async onSubmit(e,i){await this.asignNID(e);const t=await this.registrationService.createEncounter();if(!t)return Object(p["e"])("Unable to create registration encounter");const a=await this.resolveObs({...i}),n=await this.registrationService.saveObservationList(a);if(!n)return Object(p["e"])("Unable to save observations");this.nextTask()},async asignNID(e){const i=e["national_id_available"],t=e["national_id"];i&&"Yes"===i.value&&await this.patient.updateMWNationalId(t.value)},async mwIdExists(e){if(!e)return!1;const i=await v["a"].findByOtherID(b,e);return i.length>0},getFields(){return[{id:"visit_type",helpText:"Type of visit",type:d["b"].TT_SELECT,validation:e=>c["a"].required(e),computedValue:e=>({obs:this.registrationService.buildValueCoded("Type of visit",e.value)}),options:()=>[{label:"New",value:"New patient"},{label:"Referral",value:"Referral"},{label:"Re-visiting",value:"Re-visiting"}]},{id:"referring_facility_name",helpText:"Referred from",type:d["b"].TT_SELECT,validation:e=>c["a"].required(e),computedValue:({label:e})=>({obs:this.registrationService.buildValueText("Referred from",e)}),condition:e=>"Referral"===e.visit_type.value,options:(e,i="")=>Object(u["b"])(i),config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"national_id_available",helpText:"National ID Available",type:d["b"].TT_SELECT,validation:e=>c["a"].required(e),condition:()=>"Unknown"===this.patient.getMWNationalID(),options:()=>this.yesNoUnknownOptions(),appearInSummary:()=>!1},{id:"national_id",helpText:"Enter National ID",type:d["b"].TT_TEXT,validation:e=>c["a"].isMWNationalID(e),condition:e=>"Yes"===e.national_id_available.value,beforeNext:async e=>!e.value||!await this.mwIdExists(e.value.toString())||(Object(p["e"])("National ID already exists"),!1),summaryMapValue:({value:e})=>({value:e,label:"National ID"}),config:{casing:"uppercase",customKeyboard:[h["c"],[["Delete"]]]}},{id:"patient_pregnant",helpText:"Patient pregnant",type:d["b"].TT_SELECT,validation:e=>c["a"].required(e),computedValue:({value:e})=>({obs:this.registrationService.buildValueCoded("PATIENT PREGNANT",e)}),condition:()=>this.patient.isChildBearing(),options:()=>this.yesNoUnknownOptions()}]}}}),T=t("6b0d"),g=t.n(T);const m=g()(f,[["render",n]]);i["default"]=m}}]);
//# sourceMappingURL=chunk-770d622c.ebc5890f.js.map