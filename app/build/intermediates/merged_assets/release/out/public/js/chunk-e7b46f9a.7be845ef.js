(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e7b46f9a"],{"6aca":function(e,t,i){"use strict";i("779c")},"779c":function(e,t,i){},fea9:function(e,t,i){"use strict";i.r(t);var a=i("7a23");function n(e,t,i,n,o,s){const l=Object(a["resolveComponent"])("his-standard-form"),c=Object(a["resolveComponent"])("ion-page");return Object(a["openBlock"])(),Object(a["createBlock"])(c,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit,skipSummary:!0},null,8,["cancelDestinationPath","fields","onFinishAction"])]),_:1})}var o=i("9441"),s=i("7365"),l=i("331e"),c=i("c4e4");const r=Object(a["createTextVNode"])("Radiology Examination"),d=Object(a["createTextVNode"])(" Place orders "),h=Object(a["createTextVNode"])(" Close ");function p(e,t,i,n,o,s){const l=Object(a["resolveComponent"])("ion-title"),c=Object(a["resolveComponent"])("ion-toolbar"),p=Object(a["resolveComponent"])("ion-header"),m=Object(a["resolveComponent"])("his-radiology-picker"),b=Object(a["resolveComponent"])("ion-content"),u=Object(a["resolveComponent"])("ion-button"),g=Object(a["resolveComponent"])("ion-footer");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(p,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{class:"his-lg-text"},{default:Object(a["withCtx"])(()=>[r]),_:1})]),_:1})]),_:1}),Object(a["createVNode"])(b,{style:{overflow:"hidden",background:"grey",height:"70vh"}},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{onOnValue:e.onValue},null,8,["onOnValue"])]),_:1}),Object(a["createVNode"])(g,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(u,{onClick:t[1]||(t[1]=t=>e.onSubmit()),size:"large",slot:"end",disabled:0===e.emitedSelectedOptions.length},{default:Object(a["withCtx"])(()=>[d]),_:1},8,["disabled"]),Object(a["createVNode"])(u,{onClick:t[2]||(t[2]=t=>e.closeModal()),size:"large",slot:"start",color:"danger"},{default:Object(a["withCtx"])(()=>[h]),_:1})]),_:1})]),_:1})],64)}var m=i("8a30"),b=i("97ed"),u=i("adc7"),g=i("66fd"),O=i("2ef0"),C=Object(a["defineComponent"])({name:"Modal",components:{IonButton:m["d"],IonContent:m["n"],IonHeader:m["q"],IonTitle:m["R"],IonToolbar:m["S"],IonFooter:m["o"],HisRadiologyPicker:u["a"]},mixins:[s["a"]],data:()=>({radiologyService:{},isPacsEnabled:!1,emitedSelectedOptions:{}}),watch:{ready:{async handler(e){e&&(this.radiologyService=new b["a"](this.patientID,this.providerID),this.isPacsEnabled=await g["b"].isPACsEnabled())},immediate:!0,deep:!0}},methods:{async onValue(e){this.emitedSelectedOptions=e},async getSelected(){return this.emitedSelectedOptions.map(async e=>({...await this.radiologyService.buildValueCoded("Radiology Orders",e.other.parent),child:await this.radiologyService.buildValueCodedFromConceptId(e.other.parent,e.other.concept_id)}))},async onSubmit(){if(!Object(O["isEmpty"])(this.emitedSelectedOptions)){this.closeModal();let t=await this.getSelected();t=await Promise.all(t),await this.radiologyService.createEncounter();const i=await this.radiologyService.obsObj(t),a=await this.radiologyService.saveObservationList(i);if(await this.radiologyService.printOrders(t,this.patient),this.isPacsEnabled)try{await this.radiologyService.submitToPacs(a,this.patient)}catch(e){console.log(e)}}},async closeModal(){await m["Z"].dismiss([])}}}),y=i("6b0d"),v=i.n(y);const w=v()(C,[["render",p]]);var S=w,f=i("2706"),j=i("d95e"),T=i("7957"),P=i("ec2a"),x=i("9283"),_=Object(a["defineComponent"])({components:{HisStandardForm:o["a"],IonPage:m["D"]},mixins:[s["a"]],data:()=>({complaintsService:{},todaysDate:T["a"].getSessionDate(),presentingComplaints:"",isPacsEnabled:!1,radiologyBtnName:"Radiology Order",hasTriageComplaints:!1}),watch:{ready:{async handler(e){e&&(this.complaintsService=new l["a"](this.patientID,this.providerID),this.isPacsEnabled=await g["b"].isPACsEnabled(),this.hasTriageComplaints=await this.getTriagePresentingComplaints(),this.fields=this.getFields())},immediate:!0,deep:!0}},methods:{async onSubmit(e,t){const i=await Promise.all(t.complaints);await this.complaintsService.createEncounter(),await this.complaintsService.saveObservationList(i),this.nextTask()},async launchOrderSelection(){const e=await m["Z"].create({component:c["a"],backdropDismiss:!1,cssClass:"large-modal"});e.present(),await e.onDidDismiss()},async launchRadiologyOrderSelection(){const e=await m["Z"].create({component:S,backdropDismiss:!1,cssClass:"large-modal"});e.present(),await e.onDidDismiss()},async getTriagePresentingComplaints(){const e=await this.complaintsService.fetchLatestTriageEncounter();if(!(e.length>0))return!1;const t=await P["a"].getEncounters(this.patientID,this.todaysDate),i=t.filter((function(e){return"TRIAGE PRESENTING COMPLAINTS"==e.type.name&&x["b"].toStandardHisFormat(e.encounter_datetime)==T["a"].getSessionDate()}));return i.length>0&&(this.presentingComplaints=i[0].observations,!0)},buildResults(){const e=["Group","Presenting complaints"];let t="",i=this.presentingComplaints.map(e=>{if(null!=e.obs_group_id)return[t,e.value_text];t=e.value_text});return i=i.filter(e=>void 0!=e),this.presentingComplaints=i,[{label:"",value:"",other:{columns:e,rows:i}}]},getFields(){return[{id:"triage_complaints",helpText:"Triaging Complaints",condition:()=>this.hasTriageComplaints,type:j["b"].TT_TABLE_VIEWER,options:e=>this.buildResults(),config:{hiddenFooterBtns:["Clear"]}},{id:"complaints",helpText:"Presenting Complaints",type:j["b"].TT_COMPLAINTS_PICKER,validation:e=>f["a"].required(e),computedValue:e=>e.map(async e=>({...await this.complaintsService.buildValueCoded("Presenting complaint",e.other.parent),child:await this.complaintsService.buildValueCodedFromConceptId(e.other.parent,e.other.concept_id)})),config:{hiddenFooterBtns:[this.showRadiologyOdersBtn(),this.disableBackBtn()],footerBtns:[{name:"Lab Order",size:"large",slot:"end",color:"primary",visible:!0,onClick:async()=>await this.launchOrderSelection(),visibleOnStateChange:e=>1===e.index},{name:this.radiologyBtnName,size:"large",slot:"end",color:"primary",visible:!0,onClick:async()=>await this.launchRadiologyOrderSelection(),visibleOnStateChange:e=>1===e.index}]}},{id:"all_presenting_complaints",helpText:"Summary",condition:()=>this.presentingComplaints.length>0,type:j["b"].TT_SUMMARY,options:(e,t)=>this.buildSummaryResults(e),config:{hiddenFooterBtns:["Clear"]}}]},showRadiologyOdersBtn(){return this.isPacsEnabled?"":this.radiologyBtnName},buildSummaryResults(e){const t=e.complaints.map(e=>({label:"OPD Complaints",value:e.label})),i=this.presentingComplaints.map(e=>({label:"Triaging Complaints",value:e[1]}));return t.concat(i)},disableBackBtn(){return this.hasTriageComplaints?"":"Back"}}});i("6aca");const V=v()(_,[["render",n]]);t["default"]=V}}]);
//# sourceMappingURL=chunk-e7b46f9a.7be845ef.js.map