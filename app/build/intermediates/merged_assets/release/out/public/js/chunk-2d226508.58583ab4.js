(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d226508"],{e7aa:function(e,t,a){"use strict";a.r(t);var s=a("7a23");function i(e,t,a,i,n,o){const r=Object(s["resolveComponent"])("his-standard-form");return Object(s["openBlock"])(),Object(s["createBlock"])(r,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!1,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}var n=a("d95e"),o=a("7920"),r=a("2706"),l=a("7365"),u=a("cc6f");class d extends u["a"]{constructor(e,t){super(e,181,t),this.hivStatus="",this.artStatus="",this.arvNumber="",this.arvStartDate=""}getHivStatus(){return this.hivStatus}getArtStatus(){return this.artStatus}getArvNumber(){return this.arvNumber}getArvStartDate(){return this.arvStartDate}isHivPositive(){return!!this.hivStatus.match(/positive/i)}async loadArtStatus(){const e=await u["a"].getJson(`programs/12/patients/${this.patientID}/art_hiv_status`);e&&(this.hivStatus=e["hiv_status"]||this.hivStatus,this.artStatus=e["art_status"]||"",this.arvNumber=e["arv_number"]||"",this.arvStartDate=e["arv_start_date"]||"")}}var c=a("b5e4"),h=a("b446"),v=a("e86e"),b=a("8158"),m=Object(s["defineComponent"])({mixins:[l["a"]],components:{HisStandardForm:o["a"]},data:()=>({assessment:{},obs:[],showHIVQuestions:!0,offerCxCa:!1}),watch:{patient:{async handler(){this.assessment=new d(this.patientID,this.providerID),await this.assessment.loadArtStatus(),""!==this.assessment.getHivStatus()&&(this.showHIVQuestions=!1),await this.setOfferCxCa(),this.fields=await this.getFields()},deep:!0}},methods:{async onFinish(e,t){const a=await this.assessment.createEncounter();if(!a)return Object(c["e"])("Unable to create encounter");const s=[];Object.keys(t).forEach(e=>{s.push(t[e].obs)});const i=await Promise.all([...this.obs,...s]),n=await this.assessment.saveObservationList(i);if(!n)return Object(c["e"])("Unable to save patient observations");Object(c["d"])("Observations and encounter created!"),this.nextTask()},async setOfferCxCa(){const e=await this.assessment.getFirstValueCoded("Offer CxCa");return this.offerCxCa=e&&"Yes"===e,this.offerCxCa||this.obs.push(this.assessment.buildValueCoded("Ever had CxCa","No")),!0},hasHIVStatus(){return""!==this.assessment.getHivStatus},enterPreviousCxCaData(e){const t="Yes"===e.ever_had_cxca.value,a="Yes"===e.results_available.value;return t&&a},getFacilities(e=""){return Object(v["b"])(e)},getReasonsForNoCxcaOptions(){return b["a"].getConceptsByCategory("reason_for_no_cxca").map(e=>({label:e.name,value:e.name,other:{c:e}}))},getFields(){return[{id:"reason_for_visit",helpText:"Reason for visit",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),options:()=>[{label:"Initial screening",value:"Initial screening"},{label:"Postponed treatmment",value:"Postponed treatment"},{label:"One year subsequent check-up after treatment",value:"One year subsequent check-up after treatment"},{label:"Subsequent screening",value:"Subsequent screening"},{label:"Problem visit after treatment",value:"Problem visit after treatment"},{label:"Referral",value:"Referral"}],computedValue:e=>({obs:this.assessment.buildValueCoded("Reason for visit",e.value)})},{id:"hiv_status",helpText:"HIV status",type:n["b"].TT_SELECT,condition:()=>this.showHIVQuestions,validation:e=>r["a"].required(e),options:()=>[{label:"Positive on ART",value:"Positive on ART"},{label:"Positive Not on ART",value:"Positive Not on ART"},{label:"Negative",value:"Negative"},{label:"Never tested",value:"Never tested"},{label:"Prefers Not to disclose",value:"Undisclosed"}],computedValue:e=>({obs:this.assessment.buildValueCoded("HIV status",e.value)})},...Object(h["b"])({id:"hiv_test_date",helpText:"HIV test result date",required:!0,condition:e=>e.hiv_status.value.match(/Negative|ART/i),minDate:()=>this.patient.getBirthdate(),maxDate:()=>this.assessment.getDate(),estimation:{allowUnknown:!1},computeValue:(e,t)=>({date:e,tag:"cxca screening",isEstimate:t,obs:this.assessment.buildValueDate("HIV test date",e)})},this.assessment.getDate()),{id:"ever_had_cxca",helpText:"Ever had CxCa screening",type:n["b"].TT_SELECT,condition:e=>"Initial screening"!==e.reason_for_visit.value,options:()=>this.yesNoOptions(),validation:e=>r["a"].required(e),computedValue:e=>({obs:this.assessment.buildValueCoded("Ever had CxCa",e.value)})},{id:"results_available",helpText:"Results available?",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:e=>"Initial screening"!==e.reason_for_visit.value&&"No"!==e.ever_had_cxca.value,options:()=>this.yesNoOptions(),computedValue:e=>({obs:this.assessment.buildValueCoded("CxCa test results",e.value)})},{id:"location",helpText:"CxCa screening location",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),options:(e,t="")=>this.getFacilities(t),config:{showKeyboard:!0,isFilterDataViaApi:!0},condition:e=>this.enterPreviousCxCaData(e),computedValue:e=>({obs:this.assessment.buildValueText("Previous CxCa location",e.value)})},...Object(h["b"])({id:"cxca_date",helpText:"Previous CxCa test",required:!0,minDate:()=>this.patient.getBirthdate(),maxDate:()=>this.assessment.getDate(),estimation:{allowUnknown:!1},condition:e=>this.enterPreviousCxCaData(e),computeValue:(e,t)=>({date:e,tag:"cxca screening",isEstimate:t,obs:this.assessment.buildValueDate("cxca test date",e)})},this.assessment.getDate()),{id:"previous_screening_method",helpText:"Previous screening method",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:e=>this.enterPreviousCxCaData(e),options:()=>[{label:"VIA",value:"VIA"},{label:"PAP Smear",value:"PAP Smear"},{label:"HPV DNA",value:"HPV DNA"},{label:"Speculum Exam",value:"Speculum Exam"}],computedValue:e=>({obs:this.assessment.buildValueCoded("Previous CxCa screening method",e.value)})},{id:"offer_CxCa",helpText:"Offer CxCa screening today",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),options:()=>this.yesNoOptions(),computedValue:e=>({obs:this.assessment.buildValueCoded("Offer CxCa",e.value)})},{id:"screening_method",helpText:"Screening method being offered",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:e=>"Yes"===e.offer_CxCa.value,options:()=>[{label:"VIA",value:"VIA"},{label:"PAP Smear",value:"PAP Smear"},{label:"HPV DNA",value:"HPV DNA"},{label:"Speculum Exam",value:"Speculum Exam"}],computedValue:e=>({obs:this.assessment.buildValueCoded("CxCa screening method",e.value)})},{id:"reason_for_no_cxca",helpText:"Reason for NOT offering CxCa screening",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:e=>"No"===e.offer_CxCa.value,options:()=>this.getReasonsForNoCxcaOptions(),computedValue:e=>({obs:this.assessment.buildValueCoded("Reason for NOT offering CxCa",e.value)})}]}}}),p=a("6b0d"),C=a.n(p);const f=C()(m,[["render",i]]);t["default"]=f}}]);
//# sourceMappingURL=chunk-2d226508.58583ab4.js.map