{"version":3,"sources":["webpack:///./node_modules/vue-loader-v16/dist/templateLoader.js","webpack:///./node_modules/cache-loader/dist/cjs.js","webpack:///./src/components/DataViews/actionsheet/RadioActionSheet.vue","webpack:///./node_modules/eslint-loader/index.js","webpack:///./src/components/DataViews/actionsheet/InfoListActionSheet.vue?8d36","webpack:///./src/components/DataViews/actionsheet/InfoActionSheet.vue?afe0","webpack:///./src/components/Forms/HisStandardForm.vue","webpack:///./src/components/DataViews/actionsheet/TableActionSheet.vue","webpack:///./src/components/DataViews/actionsheet/InfoActionSheet.vue","webpack:///./src/components/DataViews/actionsheet/InfoListActionSheet.vue","webpack:///./src/views/PatientRegistration.vue","webpack:///./src/components/DataViews/actionsheet/RadioActionSheet.vue?c992"],"names":["_withId","_withScopeId","render","_ctx","_cache","$props","$setup","$data","$options","_component_action_header","_resolveComponent","_component_ion_radio","_component_ion_label","_component_ion_item","_component_ion_radio_group","_component_ion_list","_component_ion_content","_component_action_footer","_openBlock","_createBlock","_Fragment","_createVNode","title","subtitle","color","class","default","value","activeLabel","_renderList","list","label","index","onClick","$event","onclick","key","slot","_createTextVNode","_toDisplayString","_","buttons","defineComponent","components","IonList","IonItem","IonContent","IonRadio","IonRadioGroup","mixins","ActionSheetMixin","data","props","type","Object","required","methods","computed","actionButtons","map","b","role","match","modalController","dismiss","action","name","toastWarning","selection","__exports__","PersonAttributeService","Service","constructor","attributes","postJson","PatientRegistrationService","personId","getPersonID","setPersonID","personID","person","personAttributes","createPerson","createPersonAttributes","patient","createPatient","printPatient","updatePerson","PersonService","update","create","person_id","ProgramService","PatientPrintoutService","printNidLbl","_resolveDynamicComponent","formType","fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onFinishAction","onOnIndex","onIndex","TouchScreenForm","emits","Function","Boolean","String","formData","computedData","$emit","i","_component_his_table","_withCtx","columns","rowColors","rows","HisTable","_pushScopeId","_hoisted_1","_popScopeId","bodyTitle","innerHTML","bodyText","item","Array","async","tableActionSheet","modal","component","TableSheet","backdropDismiss","cssClass","componentProps","present","onDidDismiss","listActionSheet","ListSheet","infoActionSheet","InfoSheet","optionsActionSheet","size","RadioSheet","_component_his_standard_form","_component_ion_page","fieldComponent","HisStandardForm","IonPage","app","App","getActiveApp","ddeInstance","ddeDocID","ddeIsReassign","currentAddressAttributes","homeAddressAttributes","hasIncompleteData","editPersonData","editPerson","personAttribute","isMilitarySite","presets","registrationSummary","form","watch","query","this","PatientDemographicsExchangeService","loadDDEStatus","edit_person","dde_reassign","doc_id","setPatientID","person_attribute","initEditMode","getFields","GLOBAL_PROP","militarySiteEnabled","immediate","deep","push","personIndexField","givenNameField","familyNameField","genderField","searchResultField","concat","dobFields","homeRegionField","homeDistrictField","homeTAField","homeVillageField","currentRegionField","currentDistrictField","currentTAField","currentVillage","landmarkFields","cellPhoneField","patientTypeField","facilityLocationField","occupationField","regimentField","dateJoinedMilitaryFields","rankField","relationshipField","possibleDuplicatesField","patientRegistrationSummary","isEditMode","Store","get","patientID","parseInt","ancestryDistrict","ancestryTA","ancestryVillage","currentDistrict","currentTA","getAddresses","getGivenName","getFamilyName","getGender","getBirthdate","getPhoneNumber","getClosestLandmark","PersonField","resolvePerson","nationalIDStatus","appendNationalIDData","resolvePersonAttributes","registration","Patientservice","registerPatient","set","updateMWNationalId","malawiNationalID","onRegisterPatient","exit","$router","$route","relationship","nextTask","assign","given_name","family_name","gender","birthdate","attr","invalidate","back","editConditionCheck","includes","isEnabled","getDocID","getNationalID","assignNpid","printNationalID","delayPromise","e","toastDanger","getID","values","filter","d","isPlainObject","mapToOption","listOptions","getGivenNameField","condition","defaultValue","getFamilyNameField","IS_ANC_APP","applicationName","IS_CXCA","getGenderField","requireNext","defaultOutput","defaultComputedOutput","beforeNext","newGender","oldGender","dobConfig","getDobConfig","sdate","getSessionDate","childBearingAgeInYrs","maxDate","dayjs","subtract","format","STANDARD_DATE_FORMAT","generateDateFields","region","getHomeRegionField","district","getHomeDistrictField","homeTA","getHomeTaField","home_region","homeVillage","getHomeVillageField","currentRegion","getCurrentRegionField","getCurrentDistrictField","getCurrentTAfield","current_region","getCurrentVillageField","cellPhone","getCellNumberField","cell_phone_number","facility","getFacilityLocationField","patient_type","landmarks","getLandmarkFields","id","helpText","FieldType","TT_SELECT","computedValue","val","validation","Validation","options","PatientTypeService","getPatientTypes","TT_TEXT","occupation","minDate","HisDate","estimateDateFromAge","WorkflowService","estimation","allowUnknown","computeValue","date","OPD","Registration","TT_PERSON_RESULT_VIEW","dynamicHelpText","appearInSummary","payload","patients","searchDemographics","itemData","getPersonAttributeOptions","other","search","config","hiddenFooterBtns","footerBtns","state","disabled","onValue","isEmpty","results","createdPerson","duplicatePatients","TT_PERSON_MATCH_VIEW","c","checkPotentialDuplicates","length","toDate","toStandardHisDisplayFormat","score","patient_id","newPerson","foundPerson","comparisons","home_district","home_traditional_authority","visible","f","possible_duplicates","TT_TABLE_VIEWER","editButton","attribute","home_village","current_district","current_traditional_authority","landmark","emptySets","indexes","forEach","r","isValueEmpty","onload","reassignNpid","printNpid","confirmPatient","TT_SUMMARY","buildRegistrationSummary","keys","replace","m","toUpperCase","x","undefined","nationalIDData"],"mappings":"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","file":"js/chunk-7eb73960.cf222c83.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_his_standard_form, {\n        onOnIndex: _cache[1] || (_cache[1] = $event => (_ctx.fieldComponent='')),\n        skipSummary: true,\n        activeField: _ctx.fieldComponent,\n        fields: _ctx.fields,\n        onFinishAction: _ctx.onFinish\n      }, null, 8, [\"activeField\", \"fields\", \"onFinishAction\"])\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from \"vue\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport { generateDateFields } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport HisDate from \"@/utils/Date\"\nimport { STANDARD_DATE_FORMAT } from \"@/utils/Date\"\nimport { WorkflowService } from \"@/services/workflow_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport PersonField from \"@/utils/HisFormHelpers/PersonFieldHelper\"\nimport { PatientRegistrationService } from \"@/services/patient_registration_service\"\nimport App from \"@/apps/app_lib\"\nimport { AppInterface } from \"@/apps/interfaces/AppInterface\"\nimport { nextTask } from \"@/utils/WorkflowTaskHelper\"\nimport { isValueEmpty } from \"@/utils/Strs\"\nimport { PatientDemographicsExchangeService } from \"@/services/patient_demographics_exchange_service\"\nimport { toastDanger, toastWarning } from \"@/utils/Alerts\"\nimport { PatientTypeService } from \"@/apps/ART/services/patient_type_service\";\nimport { IonPage } from \"@ionic/vue\"\nimport { infoActionSheet } from \"@/utils/ActionSheets\"\nimport GLOBAL_PROP from \"@/apps/GLOBAL_APP/global_prop\";\nimport dayjs from \"dayjs\";\nimport { delayPromise } from \"@/utils/Timers\";\nimport Store from \"@/composables/ApiStore\"\n\nexport default defineComponent({\n  components: { HisStandardForm, IonPage },\n  data: () => ({\n    app: App.getActiveApp() as AppInterface,\n    ddeInstance: {} as any,\n    ddeDocID: '' as string,\n    ddeIsReassign: false as boolean,\n    skipSummary: false as boolean,\n    currentAddressAttributes: [\n        'current_region',\n        'current_district',\n        'current_village',\n        'current_traditional_authority'\n    ] as string[],\n    homeAddressAttributes: [\n        'home_region',\n        'home_district',\n        'home_traditional_authority',\n        'home_village'\n    ] as string[],\n    hasIncompleteData: false as boolean,\n    patient: {} as any,\n    editPersonData: {} as any,\n    editPerson: -1 as number,\n    personAttribute: '' as string,\n    activeField: '' as string,\n    fieldComponent: '' as string,\n    fields: [] as Array<Field>,\n    isMilitarySite: false,\n    presets: {} as any,\n    registrationSummary: {} as any,\n    form: {} as Record<string, Option> | Record<string, null>\n  }),\n  watch: {\n    '$route': {\n        async handler({query}: any) {\n           this.ddeInstance = new PatientDemographicsExchangeService()\n           await this.ddeInstance.loadDDEStatus()\n           if (query.edit_person) {\n                this.ddeIsReassign = query.dde_reassign\n                this.ddeDocID = query.doc_id\n                this.ddeInstance.setPatientID(query.edit_person)\n                if(query.person_attribute) this.personAttribute = query.person_attribute\n                await this.initEditMode(query.edit_person)\n            } else {\n                this.presets = query\n            }\n            this.fields = this.getFields()\n            this.isMilitarySite = await GLOBAL_PROP.militarySiteEnabled()\n        },\n        immediate: true,\n        deep: true\n    }\n  },\n  methods: {\n    getFields(): Array<Field> {\n        let fields: Array<Field> = []\n        fields.push(this.personIndexField())\n        fields.push(this.givenNameField())\n        fields.push(this.familyNameField())\n        fields.push(this.genderField())\n        fields.push(this.searchResultField())\n        fields = fields.concat(this.dobFields())\n        fields.push(this.homeRegionField())\n        fields.push(this.homeDistrictField())\n        fields.push(this.homeTAField())\n        fields.push(this.homeVillageField())\n        fields.push(this.currentRegionField())\n        fields.push(this.currentDistrictField())\n        fields.push(this.currentTAField())\n        fields.push(this.currentVillage())\n        fields = fields.concat(this.landmarkFields())\n        fields.push(this.cellPhoneField())\n        fields.push(this.patientTypeField())\n        fields.push(this.facilityLocationField())\n        fields.push(this.occupationField())\n        fields.push(this.regimentField())\n        fields = fields.concat(this.dateJoinedMilitaryFields())\n        fields.push(this.rankField())\n        fields.push(this.relationshipField())\n        fields.push(this.possibleDuplicatesField())\n        fields.push(this.patientRegistrationSummary())\n        return fields\n    },\n    isEditMode() {\n        return this.editPerson >= 1\n    },\n    async initEditMode(personId: number) {\n        this.editPerson = personId\n        this.patient = await Store.get('ACTIVE_PATIENT', { patientID: parseInt(`${this.editPerson}`)})\n        const {\n            ancestryDistrict,\n            ancestryTA,\n            ancestryVillage,\n            currentDistrict,\n            currentTA\n        } = this.patient.getAddresses()\n        this.editPersonData = {\n            'given_name': this.patient.getGivenName(),\n            'family_name': this.patient.getFamilyName(),\n            'gender': this.patient.getGender(),\n            'birthdate': this.patient.getBirthdate(),\n            'home_district': ancestryDistrict,\n            'home_traditional_authority': ancestryTA,\n            'home_village': ancestryVillage,\n            'current_district': currentDistrict,\n            'current_traditional_authority': currentTA,\n            'cell_phone_number': this.patient.getPhoneNumber(),\n            'landmark': this.patient.getClosestLandmark()\n        }\n        this.presets = this.editPersonData\n        this.skipSummary = true\n        if(this.personAttribute) {\n            this.activeField = this.personAttribute\n            this.fieldComponent = this.activeField\n        }\n    },\n    async onFinish(form: Record<string, Option> | Record<string, null>, computedData: any) {\n        if (!this.isEditMode()) {\n            return this.create(form, computedData)\n        } else {\n            return this.update(computedData)\n        }\n    },\n    async create(_: any, computedData: any) {\n        let person: any = PersonField.resolvePerson(computedData)\n        person = this.presets.nationalIDStatus == \"true\" ? this.appendNationalIDData(person) : person\n        const attributes: Array<any> = this.resolvePersonAttributes(computedData)\n        const registration: any = new PatientRegistrationService()\n        const patient = new Patientservice((await registration.registerPatient(person, attributes)))\n        const patientID = registration.getPersonID()\n\n        Store.set('ACTIVE_PATIENT', patient) // update patient store\n \n        if(this.presets.nationalIDStatus == \"true\"){ \n            this.patient = patient\n            await this.patient.updateMWNationalId(this.presets.malawiNationalID)\n        }\n\n        if (this.app.onRegisterPatient) {\n            const exit = await this.app.onRegisterPatient(\n                patientID, person, attributes, this.$router, this.$route\n            )\n            if (exit) return\n        }\n        if (person.relationship === 'Yes') {\n            return this.$router.push(`/guardian/registration/${patientID}`)\n        }\n        await nextTask(patientID, this.$router)\n    },\n    appendNationalIDData(person: any){\n       return Object.assign(person,{\n            'given_name': this.presets.given_name,\n            'family_name': this.presets.family_name,\n            'gender': this.presets.gender,\n            'birthdate': this.presets.birthdate,\n            'birthdate_estimated': false\n        })\n    },\n    async update(computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const update = new PatientRegistrationService()\n\n        update.setPersonID(this.editPerson)\n        await update.updatePerson(person)\n        for(const attr in person) {\n            if (attr in this.editPersonData) {\n                this.editPersonData[attr] = person[attr]\n            }\n        }\n        Store.invalidate('ACTIVE_PATIENT')\n        if(!this.personAttribute) return this.fieldComponent = 'edit_user'\n        this.$router.back()\n    },\n    editConditionCheck(attributes=[] as Array<string>): boolean {\n        if (this.isEditMode() && !attributes.includes(this.activeField)) {\n            return false\n        }\n        return true\n    },\n    async confirmPatient() {\n        // Attempt to assign or reassign a patient's NPID if they dont have a valid one\n        if (this.ddeInstance.isEnabled() && (!this.patient.getDocID() \n            || (this.patient.getDocID() && this.patient.getNationalID().match(/unknown/i)))) {\n                try {\n                    await this.patient.assignNpid()\n                    await this.patient.printNationalID()\n                    await delayPromise(300)\n               } catch (e) {\n                    toastDanger(`Failed to assign new NPID: ${e}`)\n                }\n        }\n        this.$router.push(`/patients/confirm?person_id=${this.patient.getID()}`)\n    },\n    resolvePersonAttributes(form: Record<string, Option> | Record<string, null>) {\n        return Object.values(form)\n                    .filter((d: any) => isPlainObject(d) && 'personAttributes' in d)\n                    .map(({personAttributes}: any) => personAttributes)\n    },\n    mapToOption(listOptions: Array<string>): Array<Option> {\n        return listOptions.map((item: any) => ({ label: item, value: item }))\n    },\n    givenNameField(): Field {\n        const name: Field = PersonField.getGivenNameField()\n        name.condition = () => this.editConditionCheck(['given_name']) && this.presets.nationalIDStatus != \"true\"\n        name.defaultValue = () => this.presets.given_name\n        return name\n    },\n    familyNameField(): Field {\n        const name: Field = PersonField.getFamilyNameField()\n        name.condition = () => this.editConditionCheck(['family_name']) && this.presets.nationalIDStatus != \"true\"\n        name.defaultValue = () => this.presets.family_name\n        return name\n    },\n    genderField(): Field {\n        const IS_ANC_APP = this.app.applicationName === 'ANC'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const gender: Field = PersonField.getGenderField()\n        gender.requireNext = this.isEditMode()\n        gender.defaultValue = () => this.presets.gender\n        gender.condition = () => {\n            if (!this.isEditMode() && (IS_ANC_APP || IS_CXCA)) {\n                return false\n            }\n            return this.editConditionCheck(['gender']) && this.presets.nationalIDStatus != \"true\"\n        }\n        if ((IS_ANC_APP || IS_CXCA) && !this.isEditMode()) {\n            gender.defaultOutput = () => ({ label: 'Female', value: 'F' })\n            gender.defaultComputedOutput = () => ({ person: 'F' })\n        } \n\n        gender.beforeNext = async (data: Option) => {\n            /**\n             * Provide warning when changing gender in edit mode\n            */\n            const newGender = data.value\n            const oldGender = this.presets.gender\n            if (this.isEditMode() && newGender != oldGender) {\n                const action = await infoActionSheet(\n                    'Warning',\n                    `Changing gender from ${oldGender} to ${newGender}`,\n                    \"This change will cause data inconsistency and will affect alot of Reports.\",\n                    [\n                        {\n                            name: 'Cancel', slot: 'start'\n                        },\n                        {\n                            name: 'Change gender', slot: 'end', color: 'danger'\n                        }\n                    ]\n                )\n                return action === 'Change gender'\n            }\n            return true\n        }\n        return gender\n    },\n    dobFields(): Array<Field> {\n        const dobConfig = PersonField.getDobConfig()\n        dobConfig.defaultValue = () => this.presets.birthdate\n        dobConfig.condition = () => this.editConditionCheck([\n            'year_birth_date', 'month_birth_date', 'day_birth_date'\n        ])\n        // ANC validation to ensure that we are not registering\n        // Non child bearing youngsters\n        if (this.app.applicationName === 'ANC') {\n            const sdate = Patientservice.getSessionDate()\n            const childBearingAgeInYrs = 12\n            dobConfig.maxDate = () => dayjs(sdate)\n                .subtract(childBearingAgeInYrs, 'years')\n                .format(STANDARD_DATE_FORMAT)\n        }\n        return generateDateFields(dobConfig)\n    },\n    homeRegionField(): Field {\n        const region: Field = PersonField.getHomeRegionField()\n        region.condition = () => this.editConditionCheck(this.homeAddressAttributes)\n        return region\n    },\n    homeDistrictField(): Field {\n        const district: Field = PersonField.getHomeDistrictField()\n        district.condition = () => this.editConditionCheck(this.homeAddressAttributes)\n        return district\n    },\n    homeTAField(): Field {\n        const homeTA: Field = PersonField.getHomeTaField()\n        homeTA.condition = (form: any) => this.editConditionCheck(this.homeAddressAttributes)\n            && !form.home_region.label.match(/foreign/i)\n        return homeTA\n    },\n    homeVillageField(): Field {\n        const homeVillage: Field = PersonField.getHomeVillageField()\n        homeVillage.condition = (form: any) => this.editConditionCheck(this.homeAddressAttributes)\n            && !form.home_region.label.match(/foreign/i)\n        return homeVillage\n    },\n    currentRegionField(): Field {\n        const currentRegion: Field = PersonField.getCurrentRegionField()\n        currentRegion.condition = () => this.editConditionCheck(this.currentAddressAttributes)\n        return currentRegion\n    },\n    currentDistrictField(): Field {\n        const currentDistrict: Field = PersonField.getCurrentDistrictField()\n        currentDistrict.condition = () => this.editConditionCheck(this.currentAddressAttributes)\n        return currentDistrict\n    },\n    currentTAField(): Field {\n        const currentTA: Field = PersonField.getCurrentTAfield()\n        currentTA.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign/i)\n        return currentTA\n    },\n    currentVillage(): Field {\n        const currentVillage: Field = PersonField.getCurrentVillageField()\n        currentVillage.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign/i)\n        return currentVillage\n    },\n    cellPhoneField(): Field {\n        const cellPhone: Field = PersonField.getCellNumberField()\n        cellPhone.condition = () => this.editConditionCheck(['cell_phone_number'])\n        cellPhone.defaultValue = () => this.presets.cell_phone_number\n        return cellPhone\n    },\n    facilityLocationField(): Field {\n       const facility: Field = PersonField.getFacilityLocationField()\n       facility.condition = (form: any) => [\n           'Drug Refill',\n           'External consultation'\n       ].includes(form.patient_type.value)\n       return facility\n    },\n    landmarkFields(): Field[] {\n        const landmarks: Field[] = PersonField.getLandmarkFields()\n        landmarks[0].condition = () => this.editConditionCheck(['default_landmarks'])\n        return landmarks\n    },\n    patientTypeField(): Field {\n        return {\n            id: 'patient_type',\n            helpText: 'Type of patient',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['patient_type'])\n                && this.app.applicationName === 'ART',\n            validation: (val: any) => Validation.required(val),\n            options: () => PatientTypeService.getPatientTypes()\n        }\n    },\n    occupationField(): Field {\n        return {\n            id: 'occupation',\n            helpText: 'Occupation',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['occupation']) && this.isMilitarySite,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption([\n                'Military',\n                'Civilian'\n            ])\n        }\n    },\n    regimentField(): Field {\n        return {\n            id: 'person_regiment_id',\n            helpText: 'Regiment ID',\n            type: FieldType.TT_TEXT,\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 35,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['person_regiment_id']) && form.occupation && form.occupation.value.match(/Military/i),\n            validation: (val: any) => Validation.required(val)\n        }\n    },\n    rankField(): Field {\n        return {\n            id: 'rank',\n            helpText: 'Rank',\n            type: FieldType.TT_SELECT,\n            validation: (val: any) => Validation.required(val),\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 36,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['rank']) && form.occupation && form.occupation.value.match(/Military/i),\n            options: () => this.mapToOption([\n                'First Lieutenant',\n                'Captain',\n                'Major',\n                'Lieutenant Colonel',\n                'Colonel',\n                'Brigadier General',\n                'Lieutenant General',\n                'General',\n                'Private',\n                'Corporal',\n                'Lance Corporal',\n                'Seargent',\n                'Staff Seargent',\n                'Warrant Officer class 1',\n                'Warrant Officer class 2'\n            ])\n        }\n    },\n    dateJoinedMilitaryFields(): Array<Field> {\n        return generateDateFields({\n            id: 'person_date_joined_military',\n            helpText: 'Joined Military',\n            required: true,\n            condition: (form: any) =>  this.editConditionCheck([\n                'year_person_date_joined_military',\n                'month_person_date_joined_military',\n                'day_person_date_joined_military'\n            ]) && form.occupation && form.occupation.value.match(/Military/i),\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => WorkflowService.getSessionDate(),\n            estimation: {\n                allowUnknown: false\n            },\n            computeValue: (date: string) => ({\n                date,\n                personAttributes : {\n                    'person_attribute_type_id': 37, 'value': date\n                }\n            })\n        })\n    },\n    relationshipField(): Field {\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const OPD = this.app.applicationName === 'OPD'\n        const Registration = this.app.applicationName === 'Registration'\n        return {\n            id: 'relationship',\n            helpText: 'Register guardian?',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['relationship']) && !IS_CXCA && !OPD && !Registration,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption(['Yes', 'No'])\n        }\n    },\n    searchResultField(): Field {\n        return {\n            id: 'results',\n            helpText: 'Search results',\n            type: FieldType.TT_PERSON_RESULT_VIEW,\n            dynamicHelpText: (form: any) => {\n                return this.presets.nationalIDStatus == \"true\" ?\n                 `Search results for \"${this.presets.given_name} ${this.presets.family_name} | ${this.presets.gender}\"` : \n                 `Search results for \"${form.given_name.value} ${form.family_name.value} | ${form.gender.label}\"`;\n            },\n            appearInSummary: () => false,\n            condition: () => !this.isEditMode(),\n            validation: (val: Option) => Validation.required(val),\n            options: async (form: any) => {\n                let payload;\n                if(this.presets.nationalIDStatus == \"true\"){\n                    this.presets.gender = this.presets.gender == \"Male\" ? \"M\" : \"F\"\n                    payload  = {\n                        'given_name': this.presets.given_name,\n                        'family_name': this.presets.family_name,\n                        'gender': this.presets.gender\n                    } \n                }\n                else{\n                    payload = {\n                        'given_name': form.given_name.value,\n                        'family_name': form.family_name.value,\n                        'gender': form.gender.value\n                    }\n                }\n                // DDE enabled search\n                if (this.ddeInstance.isEnabled()) {\n                    const patients = await this.ddeInstance.searchDemographics(payload)\n                    return patients.map((item: any) => {\n                        const itemData = PersonField.getPersonAttributeOptions(item)\n                        itemData.other.options.push({\n                            label: 'Patient Type',\n                            value: item.patient_type\n                        })\n                        itemData.other.options.push({\n                            label: 'Doc ID',\n                            value: item.doc_id\n                        })\n                        return itemData\n                    })\n                }\n                // Regular search\n                const patients = await Patientservice.search(payload);\n                return patients.map((item: any) => PersonField.getPersonAttributeOptions(item))\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next',\n                    'Back'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Edit Search',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = 'given_name'\n                        }\n                    },\n                    {\n                        name: 'New Patient',\n                        slot: 'end',\n                        onClick: () => {\n                            this.presets.nationalIDStatus != \"true\"?\n                            this.fieldComponent = 'year_birth_date':\n                            this.fieldComponent = 'home_region'\n                        }\n                    },\n                    {\n                        name: 'Continue',\n                        color: 'success',\n                        slot: 'end',\n                        state: {\n                            disabled: {\n                                default: () => true,\n                                onValue(_: any,form: any) {\n                                    return isEmpty(form.results)\n                                }\n                            }\n                        },\n                        onClick: (form: any) => {\n                            return this.$router.push(`/patients/confirm?person_id=${form.results.value}`)\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    possibleDuplicatesField(): Field {\n        let createdPerson: any = {}\n        let duplicatePatients: any = {}\n        return {\n            id: 'possible_duplicates',\n            helpText: 'Possible Duplicate(s)',\n            type: FieldType.TT_PERSON_MATCH_VIEW,\n            condition: async (_: any, c: any) => {\n                if (this.ddeInstance.isEnabled() && !this.editPerson) {\n                    createdPerson = PersonField.resolvePerson(c)\n                    duplicatePatients = await this.ddeInstance\n                        .checkPotentialDuplicates(createdPerson)\n                    return duplicatePatients.length >= 1\n                }\n                return false\n            },\n            options: async () => {\n                const toDate = (date: string) => HisDate.toStandardHisDisplayFormat(date)\n                return duplicatePatients.map(({ score, person }: any) => {\n                    const name = `${person.given_name} ${person.family_name}`\n                    return {\n                        label: name,\n                        value: person.patient_id,\n                        other: {\n                            score: `${score * 100}%`,\n                            newPerson: createdPerson,\n                            foundPerson: person,\n                            comparisons: [\n                                [\n                                    'Name',\n                                    `${createdPerson.given_name} ${createdPerson.family_name}`,\n                                    `${person.given_name} ${person.family_name}`\n                                ],\n                                [\n                                    'Gender',\n                                    createdPerson.gender,\n                                    person.gender\n                                ],\n                                [\n                                    'Birthdate',\n                                    toDate(createdPerson.birthdate),\n                                    toDate(person.birthdate)\n                                ],\n                                [\n                                    'Home District',\n                                    createdPerson.home_district,\n                                    person.home_district\n                                ],\n                                [\n                                    'Home TA',\n                                    createdPerson.home_traditional_authority,\n                                    person.home_traditional_authority\n                                ]\n                            ]\n                        }\n                    }\n                })\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Not Duplicate',\n                        slot: 'start',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: (form: any) => {\n                            this.$router.push(`/patients/confirm?person_id=${form.possible_duplicates.value}`)\n                        }\n                    }\n                ]\n            }\n\n        }\n    },\n    personIndexField(): Field {\n        return {\n            id: 'edit_user',\n            helpText: 'Edit Demographics',\n            type: FieldType.TT_TABLE_VIEWER,\n            condition: () => this.isEditMode(),\n            options: async () => {\n                const editButton = (attribute: string) => ({\n                    name: 'Edit',\n                    type: 'button',\n                    action: () => {\n                        this.activeField = attribute\n                        this.fieldComponent = this.activeField\n                    }\n                })\n                const columns = ['Attributes', 'Values', 'Edit']\n                const rows = [\n                    ['Given Name', this.editPersonData.given_name, editButton('given_name')],\n                    ['Family Name', this.editPersonData.family_name, editButton('family_name')],\n                    ['Gender', this.editPersonData.gender,  editButton('gender')],\n                    ['Birthdate', HisDate.toStandardHisDisplayFormat(this.editPersonData.birthdate),  editButton('year_birth_date')],\n                    ['Cell Phone Number', this.editPersonData.cell_phone_number, editButton('cell_phone_number')],\n                    ['Home District', this.editPersonData.home_district, editButton('home_region')],\n                    ['Home TA', this.editPersonData.home_traditional_authority,  editButton('home_region')],\n                    ['Home Village', this.editPersonData.home_village,  editButton('home_region')],\n                    ['Current district',this.editPersonData.current_district, editButton('current_region')],\n                    ['Current T/A', this.editPersonData.current_traditional_authority, editButton('current_region')],\n                    ['Landmark', this.editPersonData.landmark, editButton('default_landmarks')],\n                ]\n                // Tag rows with empty values\n                const emptySets: any = {indexes: [], class: 'his-empty-set-color'}\n                rows.forEach((r: any, i: number) => {\n                    if (isValueEmpty(r[1])) \n                        emptySets.indexes.push(i)\n                })\n                this.hasIncompleteData = emptySets.indexes.length >= 1\n                return [{\n                    label: '', \n                    value: '',\n                    other: {\n                        rows,\n                        columns,\n                        rowColors: [emptySets]\n                    }\n                }]\n            },\n            config: {\n                footerBtns: [\n                    /**\n                     * Custom button that Appears when DDE wants to\n                     * Reassign a patient with incomplete data\n                    */\n                    {\n                        name: 'Reassign',\n                        slot: 'end',\n                        color: 'success',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onload: () => (\n                                    this.ddeInstance.isEnabled()\n                                    && this.ddeIsReassign\n                                    && !this.hasIncompleteData\n                                )\n                            }\n                        },\n                        onClick: async () => {\n                            try {\n                                await this.ddeInstance.reassignNpid(this.ddeDocID, this.editPerson)\n                                await this.ddeInstance.printNpid()\n                                this.$router.push(`/patients/confirm?person_id=${this.editPerson}`)\n                            } catch(e) {\n                                toastWarning(`${e}`)\n                            }\n                        }\n                    },\n                    /**\n                     * Custom button that redirects to patient confirmation page\n                     */\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                onload: () => !this.ddeIsReassign && !this.hasIncompleteData\n                            }\n                        },\n                        onClick: async () => this.confirmPatient()\n                    }\n                ],\n                hiddenFooterBtns: ['Clear', 'Next']\n            }\n        }\n    },\n    patientRegistrationSummary(): Field \n    {\n        return{\n          id: \"registration_summary\",\n          helpText: \"Summary\",\n          type: FieldType.TT_SUMMARY,\n          condition: () => !this.skipSummary,\n          options: (f: any, c: any) => {  \n                return this.buildRegistrationSummary(c)\n          },\n          config: {\n            hiddenFooterBtns: [\"Clear\"],\n          }\n        }\n    },\n    buildRegistrationSummary(data: any){\n        data = Object.keys(data).map(function(key, index) {\n            if(data[key] != null){\n                return {\n                'label': key.replace(/_/g,' ').replace(/(^\\w|\\s\\w)/g, m => m.toUpperCase()),\n                'value': key == \"birth_date\" ? data[key]['date'] : data[key]['person']\n                } \n            }\n        });\n        data = data.filter((x: any)=>{\n            return x != undefined\n        })\n\n       const nationalIDData = [\n            {\n                'label': \"Given Name\",\n                'value': this.presets.given_name\n            },\n            {\n                'label': \"Family Name\",\n                'value': this.presets.family_name\n            },\n            {\n                'label': \"Gender\",\n                'value': this.presets.gender\n            },\n            {\n                'label': \"Birthdate\",\n                'value': this.presets.birthdate\n            },\n            {\n                'label': \"Malawi National ID\",\n                'value': this.presets.malawiNationalID\n            } \n        ]\n        if(this.presets.nationalIDStatus == \"true\")\n            data = nationalIDData.concat(data)\n\n        return data\n    }\n  }\n})\n","import { render } from \"./RadioActionSheet.vue?vue&type=template&id=23709ba4&scoped=true&ts=true\"\nimport script from \"./RadioActionSheet.vue?vue&type=script&lang=ts\"\nexport * from \"./RadioActionSheet.vue?vue&type=script&lang=ts\"\n\nimport \"./RadioActionSheet.vue?vue&type=style&index=0&id=23709ba4&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-23709ba4\"]])\n\nexport default __exports__","import TableSheet from \"@/components/DataViews/actionsheet/TableActionSheet.vue\"\nimport InfoSheet from \"@/components/DataViews/actionsheet/InfoActionSheet.vue\"\nimport RadioSheet from \"@/components/DataViews/actionsheet/RadioActionSheet.vue\"\nimport ListSheet from \"@/components/DataViews/actionsheet/InfoListActionSheet.vue\"\nimport { modalController } from \"@ionic/vue\";\n\nexport async function tableActionSheet(\n    title: string,\n    subtitle: string,\n    columns: Array<string>,\n    rows: Array<string>,\n    actionButtons: Array<any>,\n    color = '',\n    rowColors:  Array<any>=[])\n    {\n        const modal = await modalController.create({\n        component: TableSheet,\n        backdropDismiss: false,\n        cssClass: \"action-sheet-modal\",\n        componentProps: {\n            title,\n            subtitle,\n            columns,\n            rows,\n            rowColors,\n            actionButtons,\n            color\n        }\n        })\n        modal.present()\n        const { data } = await modal.onDidDismiss()\n        return data.action\n    }\n\nexport async function listActionSheet(\n    title: string,\n    subtitle: string,\n    list: Array<string>,\n    actionButtons: Array<any>,\n    color = '')\n    {\n        const modal = await modalController.create({\n        component: ListSheet,\n        backdropDismiss: false,\n        cssClass: \"action-sheet-modal\",\n        componentProps: {\n            title,\n            subtitle,\n            actionButtons,\n            list,\n            color\n        }\n        })\n        modal.present()\n        const { data } = await modal.onDidDismiss()\n        return data.action\n    }\n\nexport async function infoActionSheet(\n    title: string, \n    bodyTitle: string,\n    bodyText: string,\n    actionButtons: Array<any>,\n    color = '')\n    {\n        const modal = await modalController.create({\n        component: InfoSheet,\n        backdropDismiss: false,\n        cssClass: \"action-sheet-modal\",\n        componentProps: {\n            title,\n            bodyTitle,\n            bodyText,\n            actionButtons,\n            color\n        }\n        })\n        modal.present()\n        const { data } = await modal.onDidDismiss()\n        return data.action\n    }\n\nexport async function optionsActionSheet(\n    title: string, \n    subtitle: string, \n    list: Array<string>, \n    actionButtons: Array<any>,\n    color = 'darkred',\n    size = 'action-sheet-modal')\n    {\n        const modal = await modalController.create({\n        component: RadioSheet,\n        backdropDismiss: false,\n        cssClass: size,\n        componentProps: {\n            title,\n            subtitle,\n            color,\n            list,\n            actionButtons\n        }\n        })\n        modal.present()\n        const { data } = await modal.onDidDismiss()\n        return data\n    }\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./InfoListActionSheet.vue?vue&type=style&index=0&id=d609962e&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./InfoActionSheet.vue?vue&type=style&index=0&id=1c798292&scoped=true&lang=css\"","import { render } from \"./HisStandardForm.vue?vue&type=template&id=6daa0375&ts=true\"\nimport script from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\nexport * from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./TableActionSheet.vue?vue&type=template&id=1d30c2d4&ts=true\"\nimport script from \"./TableActionSheet.vue?vue&type=script&lang=ts\"\nexport * from \"./TableActionSheet.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./InfoActionSheet.vue?vue&type=template&id=1c798292&scoped=true&ts=true\"\nimport script from \"./InfoActionSheet.vue?vue&type=script&lang=ts\"\nexport * from \"./InfoActionSheet.vue?vue&type=script&lang=ts\"\n\nimport \"./InfoActionSheet.vue?vue&type=style&index=0&id=1c798292&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1c798292\"]])\n\nexport default __exports__","import { render } from \"./InfoListActionSheet.vue?vue&type=template&id=d609962e&scoped=true&ts=true\"\nimport script from \"./InfoListActionSheet.vue?vue&type=script&lang=ts\"\nexport * from \"./InfoListActionSheet.vue?vue&type=script&lang=ts\"\n\nimport \"./InfoListActionSheet.vue?vue&type=style&index=0&id=d609962e&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-d609962e\"]])\n\nexport default __exports__","import { render } from \"./PatientRegistration.vue?vue&type=template&id=1d75be5f&ts=true\"\nimport script from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./RadioActionSheet.vue?vue&type=style&index=0&id=23709ba4&scoped=true&lang=css\""],"sourceRoot":""}