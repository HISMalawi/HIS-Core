(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15d82f6a"],{5713:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i("1c74"),n=i("8158");class s extends a["e"]{constructor(){super()}static createAddress(e,t,i){return this.postJson("addresses",{address_type:e,addresses_name:t,parent_location:i})}static getFacilities(e={}){return super.getJson("/locations",e)}static async getSpecialistClinics(){const e=await n["a"].getConceptID("Specialist clinic");return super.getJson("/concept_set",{id:e})}static getRegions(){return super.getJson("/regions")}static getDistricts(e){return super.getJson("/districts",{region_id:e,page_size:1e3})}static getVillages(e,t=""){return super.getJson("/villages",{traditional_authority_id:e,name:t})}static getTraditionalAuthorities(e,t=""){return super.getJson("/traditional_authorities",{district_id:e,name:t})}}},c7512:function(e,t,i){"use strict";i.r(t);var a=i("7a23");function n(e,t,i,n,s,r){const o=Object(a["resolveComponent"])("his-standard-form");return Object(a["openBlock"])(),Object(a["createBlock"])(o,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit},null,8,["cancelDestinationPath","fields","onFinishAction"])}var s=i("9441"),r=i("7365"),o=i("cc6f");class l extends o["a"]{constructor(e,t){super(e,104,t)}}var c=i("2706"),u=i("d95e"),d=i("e86e"),p=i("b5e4"),g=i("23e6");const v=28;var b=Object(a["defineComponent"])({components:{HisStandardForm:s["a"]},mixins:[r["a"]],data:()=>({registrationService:{}}),watch:{ready:{async handler(e){e&&(this.registrationService=new l(this.patient.getID(),this.providerID),this.fields=this.getFields())},immediate:!0,deep:!0}},methods:{async onSubmit(e,t){await this.asignNID(e);const i=await this.registrationService.createEncounter();if(!i)return Object(p["e"])("Unable to create registration encounter");const a=await this.resolveObs({...t}),n=await this.registrationService.saveObservationList(a);if(!n)return Object(p["e"])("Unable to save observations");this.nextTask()},async asignNID(e){const t=e["national_id_available"],i=e["national_id"];t&&"Yes"===t.value&&await this.patient.updateMWNationalId(i.value)},async mwIdExists(e){if(!e)return!1;const t=await g["a"].findByOtherID(v,e);return t.length>0},getFields(){return[{id:"visit_type",helpText:"Type of visit",type:u["b"].TT_SELECT,validation:e=>c["a"].required(e),computedValue:e=>({obs:this.registrationService.buildValueCoded("Type of visit",e.value)}),options:()=>[{label:"New",value:"New patient"},{label:"Referral",value:"Referral"},{label:"Re-visiting",value:"Re-visiting"}]},{id:"referring_facility_name",helpText:"Referred from",type:u["b"].TT_SELECT,validation:e=>c["a"].required(e),computedValue:({label:e})=>({obs:this.registrationService.buildValueText("Referred from",e)}),condition:e=>"Referral"===e.visit_type.value,options:(e,t="")=>Object(d["b"])(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"national_id_available",helpText:"National ID Available",type:u["b"].TT_SELECT,validation:e=>c["a"].required(e),condition:()=>"Unknown"===this.patient.getMWNationalID(),options:()=>this.yesNoUnknownOptions(),appearInSummary:()=>!1},{id:"national_id",helpText:"Enter National ID",type:u["b"].TT_TEXT,validation:e=>c["a"].isMWNationalID(e),condition:e=>"Yes"===e.national_id_available.value,beforeNext:async e=>!e.value||!await this.mwIdExists(e.value.toString())||(Object(p["e"])("National ID already exists"),!1),summaryMapValue:({value:e})=>({value:e,label:"National ID"}),config:{casing:"uppercase"}},{id:"patient_pregnant",helpText:"Patient pregnant",type:u["b"].TT_SELECT,validation:e=>c["a"].required(e),computedValue:({value:e})=>({obs:this.registrationService.buildValueCoded("PATIENT PREGNANT",e)}),condition:()=>this.patient.isChildBearing(),options:()=>this.yesNoUnknownOptions()}]}}}),h=i("6b0d"),f=i.n(h);const m=f()(b,[["render",n]]);t["default"]=m},e86e:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"a",(function(){return c})),i.d(t,"f",(function(){return u})),i.d(t,"g",(function(){return d}));var a=i("5713"),n=i("2ef0");async function s(e=""){const t=await a["a"].getFacilities({name:e});return t.filter(e=>!Object(n["isEmpty"])(e)).map(e=>({label:e.name,value:e.location_id,other:e}))}async function r(e=""){const t=await a["a"].getFacilities({name:e,tag:"Facility adult sections"});return t.map(e=>({label:e.name,value:e.name,other:e}))}async function o(){const e=await a["a"].getSpecialistClinics();return e.map(e=>({label:e.name,value:e.name,other:e}))}async function l(){const e=await a["a"].getRegions();return e.map(e=>({label:e.name,value:e.region_id,other:e}))}async function c(e){const t=await a["a"].getDistricts(e);return t.map(e=>({label:e.name,value:e.district_id,other:e}))}async function u(e,t=""){const i=await a["a"].getTraditionalAuthorities(e,t);return i.map(e=>({label:e.name,value:e.traditional_authority_id,other:e}))}async function d(e,t=""){const i=await a["a"].getVillages(e,t);return i.map(e=>({label:e.name,value:e.village_id,other:e}))}}}]);
//# sourceMappingURL=chunk-15d82f6a.6d3f3deb.js.map