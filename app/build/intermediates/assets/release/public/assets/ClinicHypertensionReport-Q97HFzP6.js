import{d as h,I as D,J as A,bA as w,_ as v,r as d,o as P,c as $,w as C,b as _,c2 as E,K as g,N as M,a9 as R,O as f,t as F,q as S}from"./index-ru8RXlaa.js";import{v as y}from"./TableView-y6cRmPnC.js";import{D as G}from"./ReportDateSelectionPrompt-eYua7e2Q.js";import{C as H}from"./clinic_report_service-OwbUuYmD.js";import"./PopupKeyboard-pOAE1R5L.js";import"./SIngleTouchField-Vfu2y1a0.js";import"./dynamic-import-helper-9HnG3Mif.js";import"./TouchScreenForm-QVpoxsVO.js";import"./ToolbarMediumCard-Mlzu3SIO.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-LUNlto_Q.js";import"./HisKeypad-SWQeflLk.js";import"./BaseKeyboard-Ac7oOUZ2.js";import"./KbLayouts-9dqmDWmG.js";import"./KbHandler-oqPdZ1-Q.js";import"./overlays-9d7511dd-ZrAfACNh.js";import"./fuse-lCMBsAWg.js";import"./Export-jNK5-P5e.js";import"./HisKeyboard-X4xvPg-w.js";import"./HisKbConfigurations-a7K7dizM.js";import"./MultiFieldDateHelper-5DHelb14.js";const I=h({components:{v2Datatable:y,IonPage:D},props:{title:String,patients:Array,onFinish:Function},setup(){const i=A();return{ITEMS_PER_PAGE:20,columns:[[{label:"ARV Number",ref:"arv_number"},{label:"Gender",ref:"gender",value:t=>w(t.gender)},{label:"Systolic/Diastolic",ref:"diastolic",value:t=>"".concat(t.systolic,"/").concat(t.diastolic)},{label:"Action",ref:"patient_id",exportable:!1,tdClick:({data:t})=>i.push({path:"/patient/dashboard/".concat(t.patient_id)}),value:()=>"View client"}]]}}});function T(e,i,s,t,l,o){const c=d("v2Datatable"),m=d("ion-page");return P(),$(m,null,{default:C(()=>[_(c,{title:e.title,columnData:e.patients,columns:e.columns,"on-finish":e.onFinish,"icon-url":"/assets/images/folder.png",rowsPerPage:e.ITEMS_PER_PAGE},null,8,["title","columnData","columns","on-finish","rowsPerPage"])]),_:1})}const N=v(I,[["render",T]]),V=h({components:{IonPage:D,IonLoading:E,v2Datatable:y},setup(){const e=R("reports.png"),i=g([]),s=g(""),t=g(!1),l=new H,o=(r,a)=>({label:r,ref:a,toValue:n=>n.length,tdClick:n=>m("".concat(n.column.label),n.refData)}),c=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},o("Screened for HP","screened"),o("Normal <140/<90","normal_reading"),o("Mild 140-159/90-99","mild_reading"),o("Moderate 160-180/100-110","moderate_reading"),o("Severe >180/>110","severe_reading"),o("Hydrochlorothiazide 25mg","hydrochlorothiazide_25mg"),o("Amlodipine 5mg","amlodipine_5mg"),o("Amlodipine 10 mg","amlodipine_10mg"),o("Enalapril 5 mg","enalapril_5mg"),o("Enalapril 10mg","enalapril_10mg"),o("Atenolol 50mg","atenolol_50mg"),o("Atenolol 100mg","atenolol_100mg"),o("Total (regimen)","total_regimen")]],m=async(r,a)=>{a.length&&(await f.create({component:N,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:r,subtitle:s,patients:a,onFinish:()=>f.getTop().then(n=>n&&f.dismiss())}})).present()},u=async()=>{if(!(l.startDate&&l.endDate))return F("Start date and end date required!");t.value=!0,i.value=[];try{const r=await l.getHypertensionReport(),a=Object.keys(r).reduce((n,p)=>(n.M.push({age_group:p,gender:"Male",...r[p].M}),n.F.push({age_group:p,gender:"Female",...r[p].F}),n),{F:[],M:[]});i.value=a.F.concat(a.M).map((n,p)=>({index:p+1,...n}))}catch(r){S("Unable to generate report!"),console.error(r)}t.value=!1},b=()=>G({onFinish:(r,a,n)=>{s.value="Period (".concat(n,")"),l.startDate=r,l.endDate=a,u()}});return M(()=>b()),{logo:e,reportData:i,isLoading:t,configure:b,generate:u,columns:c,period:s}}});function k(e,i,s,t,l,o){const c=d("ion-loading"),m=d("v2Datatable"),u=d("ion-page");return P(),$(u,null,{default:C(()=>[_(c,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),_(m,{title:"Hypertension Report","icon-url":e.logo,subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:30,onConfigure:e.configure,onRefresh:()=>e.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const ie=v(V,[["render",k]]);export{ie as default};
