import{d as S,bt as k,C as $,T as l,h as d,Y as m,e as p,Q as C,a5 as T,ap as F,_ as x,M as h,o as a,c as B,w as _,a as t,n as c,F as f,q as g,m as H,b as y,t as o,ai as I,p as E,f as L}from"./index-VkXRcily.js";import{L as N}from"./LabOrderModal-BAKbGF7i.js";import{_ as P}from"./FieldMixin.vue_vue_type_script_lang-BZsrLmVY.js";import"./lab_order_service-CJ4J8kuX.js";const V=S({components:{ViewPort:k,IonButton:$},mixins:[P],data:()=>({HisDate:l,rows:[],fetchingOrders:!1,ordersToday:{}}),methods:{async init(){this.$emit("onFieldActivated",this),this.fetchingOrders=!0;let s=[];try{s=await this.options(this.fdata)}catch(e){console.error("".concat(e))}this.fetchingOrders=!1;const r=s[0].other.values;this.ordersToday=r.reduce((e,i)=>(d(i.ordered)===d(m.getSessionDate())&&!i.result.length&&(e[i.test_name]=!0),e),{}),this.rows=r.map(e=>(e.id=e.order_id,e.ordered&&(e.ordered=l.toStandardHisDisplayFormat(e.ordered)),e.released&&(e.released=l.toStandardHisDisplayFormat(e.released)),e))},async printOrder(s){var r;if(d(s.ordered)!=d(m.getSessionDate()))return p("Printing order #".concat(s.accession_number," is restricted to today. Consider using BDE mode/set session date to the order date"));typeof((r=this.config)==null?void 0:r.printOrder)=="function"&&await C("Do you want to print order with accession number ".concat(s.accession_number,"?"))&&this.config.printOrder(s.id)},formatOrders(s){return s.map(r=>({id:r.order_id,encounter_id:r.encounter_id,result_given:r.result_given,accession_number:r.accession_number,test_name:r.tests[0].name,specimen:r.specimen.name,ordered:l.toStandardHisDisplayFormat(r.order_date),result:[],release:""}))},async launchOrderSelection(s=null){if(this.fetchingOrders)return p("Please wait....");const r=await T.create({component:N,backdropDismiss:!1,cssClass:"large-modal",componentProps:{testFilters:s,ordersToday:this.ordersToday,onOrderAdded:i=>this.ordersToday[i]=!0}});r.present();const{data:e}=await r.onDidDismiss();F.isEmpty(e)||(this.rows=[...this.formatOrders(e),...this.rows])}},mounted(){this.init()},activated(){this.init()}}),w=s=>(E("data-v-c8e35324"),s=s(),L(),s),A={class:"view-port-content"},M={class:"his-sm-text"},R=w(()=>t("tr",null,[t("th",null,"Accession #"),t("th",null,"Test Name"),t("th",null,"Specimen"),t("th",null,"Ordered"),t("th",null,"Result"),t("th",null,"Released"),t("th",null,"Given")],-1)),Y=w(()=>t("br",null,null,-1));function q(s,r,e,i,z,G){const v=h("ion-button"),b=h("view-port");return a(),B(b,null,{default:_(()=>[t("div",A,[t("table",M,[R,(a(!0),c(f,null,g(s.rows,(n,O)=>(a(),c("tr",{key:O},[t("td",null,[H(v,{color:"light",fill:"none",onClick:u=>s.printOrder(n)},{default:_(()=>[y(o(n.accession_number),1)]),_:2},1032,["onClick"])]),t("td",null,o(n.test_name),1),t("td",null,o(n.specimen),1),t("td",null,o(n.ordered),1),t("td",null,[(a(!0),c(f,null,g(n.result,(u,D)=>(a(),c("span",{key:D},[y(o(u)+" ",1),Y]))),128))]),t("td",null,o(n.released),1),t("td",null,[t("span",{style:I("color: ".concat(n.result_given==="Yes"?"green;":"black;"))},o(n.result_given),5)])]))),128))])])]),_:1})}const K=x(V,[["render",q],["__scopeId","data-v-c8e35324"]]);export{K as default};
