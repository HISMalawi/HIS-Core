(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0de711"],{8652:function(e,t,i){"use strict";i.r(t);var a=i("7a23");function s(e,t,i,s,n,o){const l=Object(a["resolveComponent"])("his-standard-form");return Object(a["openBlock"])(),Object(a["createBlock"])(l,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit},null,8,["cancelDestinationPath","fields","onFinishAction"])}var n=i("9441"),o=i("7365"),l=i("2706"),c=i("d95e"),r=i("e86e"),v=i("b446"),u=i("b5e4"),d=i("cc6f");class h extends d["a"]{constructor(e,t){super(e,39,t)}}var b=Object(a["defineComponent"])({components:{HisStandardForm:n["a"]},mixins:[o["a"]],data:()=>({hivService:{}}),watch:{ready:{async handler(e){e&&(this.hivService=new h(this.patient.getID(),this.providerID),this.fields=this.getFields())},immediate:!0,deep:!0}},methods:{async onSubmit(e,t){const i=await this.hivService.createEncounter();if(!i)return Object(u["e"])("Unable to create encounter");const a=await this.resolveObs({...t}),s=await this.hivService.saveObservationList(a);if(!s)return Object(u["e"])("Unable to save observations");this.nextTask()},buildDateObs(e,t,i){let a={};return a=t.match(/unknown/i)?this.hivService.buildValueText(e,"Unknown"):i?this.hivService.buildValueDateEstimated(e,t):this.hivService.buildValueDate(e,t),a},getFields(){return[{id:"hiv_status",helpText:"HIV status",type:c["b"].TT_SELECT,validation:e=>l["a"].required(e),computedValue:({value:e})=>({obs:this.hivService.buildValueText("HIV status",e)}),options:()=>[{label:"Positive not ART",value:"Positive not ART"},{label:"Posititve on ART",value:"Positive on ART"},{label:"Previous negative",value:"Previous negative"},{label:"New positive",value:"New positive"},{label:"New negative",value:"New negative"},{label:"Never tested",value:"Never tested"}]},...Object(v["b"])({id:"hiv_test_date",helpText:"HIV Test",required:!0,minDate:()=>this.patient.getBirthdate(),maxDate:()=>h.getSessionDate(),condition:e=>"Never tested"!==e.hiv_status.value,summaryLabel:"HIV test date",estimation:{allowUnknown:!0,estimationFieldType:v["a"].MONTH_ESTIMATE_FIELD},computeValue:(e,t)=>this.buildDateObs("HIV test date",e,t)},this.hivService.getDate()),{id:"test_location",helpText:"HIV test location",type:c["b"].TT_SELECT,validation:e=>l["a"].required(e),defaultValue:()=>h.getLocationName(),computedValue:({label:e})=>({obs:this.hivService.buildValueText("HIV test location",e)}),condition:e=>"Never tested"!==e.hiv_status.value,options:(e,t="")=>Object(r["b"])(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}}]}}}),p=i("6b0d"),m=i.n(p);const T=m()(b,[["render",s]]);t["default"]=T}}]);
//# sourceMappingURL=chunk-2d0de711.1bffcf94.js.map