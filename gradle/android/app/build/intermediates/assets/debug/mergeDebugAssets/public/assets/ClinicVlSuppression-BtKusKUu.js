import{d as v,E as _,cl as C,j as m,a4 as h,an as w,a5 as d,e as b,U as S,_ as L,M as g,o as P,c as R,w as V,m as D}from"./index-VkXRcily.js";import{v as $}from"./TableView-5CvZUe-6.js";import{D as k}from"./ReportDateSelectionPrompt-C4poDth6.js";import{C as y}from"./clinic_report_service-Dnw81l3h.js";import{A}from"./ArtDrilldown-DWSWzV0m.js";import"./Export-C2YlkRsK.js";const B=v({components:{IonPage:_,IonLoading:C,v2Datatable:$},setup(){const e=w("reports.png"),s=m([]),l=m(""),i=m(!1),a=new y,r=(n,t)=>({label:n,ref:t,toValue:o=>o.length,tdClick:o=>u("".concat(o.column.label),o.refData)}),p=[[{label:"Regimen",ref:"regimen"},r("Due for VL","due_for_vl"),r("Sample drawn","drawn"),r("High vl (>=1000 copies))","high_vl"),r("Low vl (<1000 copies))","low_vl")]],u=async(n,t)=>{t.length&&(await d.create({component:A,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:n,subtitle:l,patientIdentifiers:t,onFinish:()=>d.getTop().then(o=>o&&d.dismiss())}})).present()},c=async()=>{if(!(a.startDate&&a.endDate))return b("Start date and end date required!");i.value=!0,s.value=[];try{s.value=await a.getVlSuppressionReport()}catch(n){S("Unable to generate report!"),console.error(n)}i.value=!1},f=()=>k({onFinish:(n,t,o)=>{l.value="Period (".concat(o,")"),a.startDate=n,a.endDate=t,c()}});return h(()=>f()),{logo:e,reportData:s,isLoading:i,configure:f,generate:c,columns:p,period:l}}});function F(e,s,l,i,a,r){const p=g("ion-loading"),u=g("v2Datatable"),c=g("ion-page");return P(),R(c,null,{default:V(()=>[D(p,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),D(u,{title:"Clinic VL Suppression Report","icon-url":e.logo,subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:30,onConfigure:e.configure,onRefresh:()=>e.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const I=L(B,[["render",F]]);export{I as default};
