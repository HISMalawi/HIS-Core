import{d as b,E as D,a1 as A,bP as E,h as M,_ as v,M as g,o as C,c as P,w as $,m as f,cl as w,j as u,a4 as R,an as F,a5 as _,e as S,U as G}from"./index-VkXRcily.js";import{v as y}from"./TableView-5CvZUe-6.js";import{D as H}from"./ReportDateSelectionPrompt-C4poDth6.js";import{C as N}from"./clinic_report_service-Dnw81l3h.js";import"./Export-C2YlkRsK.js";const T=b({components:{v2Datatable:y,IonPage:D},props:{title:String,patients:Array,onFinish:Function},setup(){const i=A();return{ITEMS_PER_PAGE:20,columns:[[{label:"ARV Number",ref:"arv_number"},{label:"Gender",ref:"gender",value:n=>E(n.gender)},{label:"Systolic/Diastolic",ref:"diastolic",value:n=>"".concat(n.systolic,"/").concat(n.diastolic)},{label:"Art start date",ref:"art_start_Date",value:n=>M(n.art_start_date)},{label:"Action",ref:"patient_id",exportable:!1,tdClick:({data:n})=>i.push({path:"/patient/dashboard/".concat(n.patient_id)}),value:()=>"View client"}]]}}});function I(o,i,s,n,l,e){const c=g("v2Datatable"),m=g("ion-page");return C(),P(m,null,{default:$(()=>[f(c,{title:o.title,columnData:o.patients,columns:o.columns,"on-finish":o.onFinish,"icon-url":"/assets/images/folder.png",rowsPerPage:o.ITEMS_PER_PAGE},null,8,["title","columnData","columns","on-finish","rowsPerPage"])]),_:1})}const V=v(T,[["render",I]]),k=b({components:{IonPage:D,IonLoading:w,v2Datatable:y},setup(){const o=F("reports.png"),i=u([]),s=u(""),n=u(!1),l=new N,e=(a,r)=>({label:a,ref:r,toValue:t=>t.length,tdClick:t=>m("".concat(t.column.label),t.refData)}),c=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},e("Screened for HTN","screened"),e("Normal <140/<90","normal_reading"),e("Mild 140-159/90-99","mild_reading"),e("Moderate 160-180/100-110","moderate_reading"),e("Severe >180/>110","severe_reading"),e("Hydrochlorothiazide 25mg","hydrochlorothiazide_25mg"),e("Amlodipine 5mg","amlodipine_5mg"),e("Amlodipine 10 mg","amlodipine_10mg"),e("Captopril 25mg","captopril_25mg"),e("Captopril 6-25mg","captopril_6_25mg"),e("Captopril 12-5mg","captopril_12_5mg"),e("Captopril 50mg","captopril_50mg"),e("Enalapril 5 mg","enalapril_5mg"),e("Enalapril 10mg","enalapril_10mg"),e("Atenolol 50mg","atenolol_50mg"),e("Atenolol 100mg","atenolol_100mg"),e("Nifedipine 10mg","nifedipine_10mg"),e("Nifedipine 20mg","nifedipine_20mg"),e("Total (regimen)","total_regimen")]],m=async(a,r)=>{r.length&&(await _.create({component:V,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:a,subtitle:s,patients:r,onFinish:()=>_.getTop().then(t=>t&&_.dismiss())}})).present()},d=async()=>{if(!(l.startDate&&l.endDate))return S("Start date and end date required!");n.value=!0,i.value=[];try{const a=await l.getHypertensionReport(),r=Object.keys(a).reduce((t,p)=>(t.M.push({age_group:p,gender:"Male",...a[p].M}),t.F.push({age_group:p,gender:"Female",...a[p].F}),t),{F:[],M:[]});i.value=r.F.concat(r.M).map((t,p)=>({index:p+1,...t}))}catch(a){G("Unable to generate report!"),console.error(a)}n.value=!1},h=()=>H({onFinish:(a,r,t)=>{s.value="Period (".concat(t,")"),l.startDate=a,l.endDate=r,d()}});return R(()=>h()),{logo:o,reportData:i,isLoading:n,configure:h,generate:d,columns:c,period:s}}});function L(o,i,s,n,l,e){const c=g("ion-loading"),m=g("v2Datatable"),d=g("ion-page");return C(),P(d,null,{default:$(()=>[f(c,{"is-open":o.isLoading,message:"Please wait..."},null,8,["is-open"]),f(m,{title:"Hypertension Report","icon-url":o.logo,subtitle:o.period,columns:o.columns,columnData:o.reportData,rowsPerPage:30,onConfigure:o.configure,onRefresh:()=>o.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const O=v(k,[["render",L]]);export{O as default};
