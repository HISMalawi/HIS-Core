import{d as J,s as X,z as K,aG as W,A as Z,v as x,I as ee,C as te,D as ne,x as se,ci as oe,a1 as ae,j as q,a3 as S,am as le,cm as re,cn as ce,co as ue,cp as ie,cq as de,dh as he,aP as me,Y as I,i as pe,ap as T,_ as _e,M as y,o as r,n as u,m,w as d,b as H,t as p,X as $,a as c,c as O,F as _,q as b,aJ as V}from"./index-VkXRcily.js";import{b as fe,t as ye}from"./Export-C2YlkRsK.js";const be=J({components:{IonToolbar:X,IonItem:K,IonIcon:W,IonLabel:Z,IonTitle:x,IonHeader:ee,IonButton:te,IonFooter:ne,IonContent:se,IonButtons:oe},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]}},setup(t){const D=ae(),M=q([]),z=q(""),A=q("desc"),Q=S(()=>t.columns.slice(0,2)),j=S(()=>{var e;const n=[];return(e=t.columnData[0])==null||e.forEach(s=>{const o=t.columns[1].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),R=S(()=>{var e;const n=[];return(e=t.columnData[1])==null||e.forEach(s=>{const o=t.columns[2].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),g=S(()=>{var e;const n=[];return(e=t.columnData[2])==null||e.forEach(s=>{const o=t.columns[3].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),U=S(()=>{var e;const n=[];return(e=t.columnData[3])==null||e.forEach((s,o)=>{const a=t.columns[8+o].map(l=>{let i="";try{T.isEmpty(s)?i="...":typeof l.value=="function"?i=l.value(s):i=s[l.ref]||""}catch(f){i="_ERROR_",console.error(f)}return{column:l,data:s,value:i,[l.ref||"nada"]:i}});n.push({row:a,data:s,searchIndex:[...a,a.map(l=>l.value).join(" ")]})}),n}),F=n=>{z.value=n,A.value=A.value==="asc"?"desc":"asc"},B=()=>{typeof t.onFinish=="function"?t.onFinish():D.push("/")},N=n=>{var e,s;try{typeof((e=n.column)==null?void 0:e.tdClick)=="function"&&((s=n.column)==null||s.tdClick(n));return}catch(o){console.error(o)}},L=()=>t.columns.reduce((n,e)=>n.concat(e),[]).filter(n=>n.value||n.ref),P=()=>{var e;const n=(e=window==null?void 0:window.document)==null?void 0:e.getElementById("report-content");fe("\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: center;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ".concat(n.innerHTML,"    \n                </body>\n                </html>\n            "))},Y=()=>{const n=f=>f.map(k=>k.map(v=>t.order.map(w=>{const C=v[w];return Array.isArray(C)?C.length:C}).filter(w=>w!==void 0)).filter(v=>v.length>0)).filter(k=>k.length>0),e=f=>f.map(E=>{const[k]=Object.keys(E),v=E[k],w=Array.isArray(v)?v.length:0,C=[k,w];for(let G=0;G<5;G++)C.push("");return C}),s=n(t.columnData),o=e(t.columnData[3]),a=s.flat();o.forEach(f=>{a.push(f)});const l="".concat(I.getLocationName()||"Unknown site","-").concat(t.title,"-").concat(t.subtitle,"-").concat(I.getSessionDate()),i=()=>{const f=[...a],E=[0,9,18,27],k=t.csvSubHeader.length;return E.forEach((v,w)=>{const C=t.csvSubHeader[w%k];f.splice(v,0,[...C])}),f};ye([t.headers],[...i(),["Date Created: ".concat(pe().format("DD/MMM/YYYY HH:MM:ss"))],["Quarter: ".concat(t.csvQuarter||t.subtitle)],["HIS-Core Version: ".concat(I.getCoreVersion())],["API Version: ".concat(I.getApiVersion())],["Site UUID: ".concat(I.getSiteUUID())],["Generated by: ".concat(I.getUserName())]],l)},h=n=>{n.forEach(e=>{const s=L().map(o=>{let a="";try{T.isEmpty(e)?a="...":typeof o.value=="function"?a=o.value(e):a=e[o.ref]||""}catch(l){a="_ERROR_",console.error(l)}return{column:o,data:e,value:a,[o.ref||"nada"]:a}});M.value.push({row:s,data:e,searchIndex:[...s,s.map(o=>o.value).join(" ")]})})};return le(()=>t.columnData,n=>{M.value=[],Array.isArray(n)&&h(n)},{immediate:!0,deep:!0}),{sortColumn:F,onClickTablecell:N,toPDF:P,toCSV:Y,finish:B,columnsMinusOne:Q,sync:re,search:ce,close:ue,arrowUp:ie,arrowDown:de,document:he,calendar:me,sortOrder:A,sectionOne:j,sectionTwo:R,sectionThree:g,sectionTotals:U,columnSorted:z}}}),ke={key:0},ve={class:"his-sm-text"},Ce={id:"report-content"},ge={class:"art-report-theme"},we={class:"stick-report-header"},De=["colspan","rowspan","onClick"],Ie={colspan:7},Re={class:"his-sm-text"},Ee=["onClick"],Se={class:"his-sm-text"},Te={colspan:7},$e={class:"his-sm-text"},Ae=["onClick"],Fe={class:"his-sm-text"},He={colspan:7},Oe={class:"his-sm-text"},Ve=["onClick"],Me={class:"his-sm-text"},ze={colspan:7},je={class:"his-sm-text"},Ue={colspan:"2"},Be={class:"his-sm-text"},Ne={colspan:"6"},Le=["onClick"];function Pe(t,D,M,z,A,Q){const j=y("ion-title"),R=y("ion-icon"),g=y("ion-button"),U=y("ion-buttons"),F=y("ion-toolbar"),B=y("ion-header"),N=y("ion-label"),L=y("ion-item"),P=y("ion-content"),Y=y("ion-footer");return r(),u(_,null,[m(B,null,{default:d(()=>[m(F,null,{default:d(()=>[m(j,{class:"his-md-text"},{default:d(()=>[H(p(t.title)+" ",1),t.subtitle?(r(),u("br",ke)):$("",!0),c("span",ve,p(t.subtitle),1)]),_:1}),m(U,{slot:"end"},{default:d(()=>[typeof t.onConfigure=="function"?(r(),O(g,{key:0,onClick:t.onConfigure},{default:d(()=>[m(R,{size:"large",icon:t.calendar},null,8,["icon"])]),_:1},8,["onClick"])):$("",!0),typeof t.onRefresh=="function"?(r(),O(g,{key:1,onClick:t.onRefresh,color:"success",size:"large"},{default:d(()=>[m(R,{size:"large",icon:t.sync},null,8,["icon"])]),_:1},8,["onClick"])):$("",!0)]),_:1})]),_:1})]),_:1}),m(P,{"scroll-y":"","scroll-x":""},{default:d(()=>[c("div",Ce,[c("table",ge,[c("thead",we,[(r(!0),u(_,null,b(t.columnsMinusOne,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(_,null,b(h,(e,s)=>{var o,a;return r(),u("th",{key:s,colspan:((o=e==null?void 0:e.span)==null?void 0:o.thColspan)||1,rowspan:((a=e==null?void 0:e.span)==null?void 0:a.thRowspan)||1,onClick:l=>t.sortColumn(e.ref)},[m(L,{lines:"none"},{default:d(()=>[t.columnSorted&&t.columnSorted===e.ref?(r(),O(R,{key:0,icon:t.sortOrder==="asc"?t.arrowUp:t.arrowDown},null,8,["icon"])):$("",!0),n<t.columns.length-1?(r(),O(N,{key:1,class:"ion-text-center"},{default:d(()=>[c("b",null,p(e.label),1)]),_:2},1024)):$("",!0)]),_:2},1024)],8,De)}),128))]))),128))]),c("tbody",null,[c("tr",null,[c("td",Ie,[c("span",Re,p(t.columns[4][0].label),1)])]),(r(!0),u(_,null,b(t.sectionOne,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(_,null,b(h.row||[],(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("b",Se,p(e.value),1)],10,Ee)}),128))]))),128)),c("tr",null,[c("td",Te,[c("span",$e,p(t.columns[5][0].label),1)])]),(r(!0),u(_,null,b(t.sectionTwo,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(_,null,b(h.row,(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("span",Fe,p(e.value),1)],10,Ae)}),128))]))),128)),c("tr",null,[c("td",He,[c("span",Oe,p(t.columns[6][0].label),1)])]),(r(!0),u(_,null,b(t.sectionThree,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(_,null,b(h.row,(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("span",Me,p(e.value),1)],10,Ve)}),128))]))),128)),c("tr",null,[c("td",ze,[c("span",je,p(t.columns[7][0].label),1)])]),(r(!0),u(_,null,b(t.sectionTotals,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(_,null,b(h.row,(e,s)=>{var o;return r(),u(_,{key:s},[c("td",Ue,[c("span",Be,p(e.column.label),1)]),c("td",Ne,[c("span",{class:V(["his-sm-text",{"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick}]),onClick:()=>t.onClickTablecell(e)},p(e.value),11,Le)])],64)}),128))]))),128))])])])]),_:1}),m(Y,null,{default:d(()=>[m(F,{color:"dark"},{default:d(()=>[m(g,{onClick:D[0]||(D[0]=h=>t.toCSV()),size:"large"},{default:d(()=>[H(" CSV ")]),_:1}),m(g,{onClick:D[1]||(D[1]=h=>t.toPDF()),size:"large"},{default:d(()=>[H(" PDF ")]),_:1}),m(g,{onClick:t.finish,color:"success",size:"large",slot:"end"},{default:d(()=>[H(" Finish ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const Qe=_e(be,[["render",Pe],["__scopeId","data-v-663672d2"]]);export{Qe as v};
