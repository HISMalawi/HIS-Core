var c=Object.defineProperty;var l=(t,s,e)=>s in t?c(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var a=(t,s,e)=>l(t,typeof s!="symbol"?s+"":s,e);import{_ as m}from"./ReportMixin.vue_vue_type_script_lang-a2Cv1Xr1.js";import{R as u}from"./TableReportTemplate-CNNSGRI2.js";import{bM as f,d as g,x as R,T as r,A as _,B as p,o as T,c as w,w as D,a as k}from"./index-CmAu9cV_.js";import"./BasicReportTemplate-FCQOkDhr.js";import"./Export-DV3j_OQc.js";import"./Pagination-Dpv4ieGX.js";import"./HisStandardForm-7nJndMCO.js";import"./ReportErrors-Bih00KK0.js";class b extends f{constructor(){super();a(this,"regenerate");a(this,"data");a(this,"clients");this.clients=[],this.data=[],this.regenerate=!1}setRegenerate(e){this.regenerate=e}async generateReport(){this.data=[],this.clients=[];const e=await this.getReport("latest_regimen_dispensed",this.buildRequest({rebuild_outcome:this.regenerate}));if(!e)return[];for(const o in e){for(const n in e[o]){const i=e[o][n];this.data.push({identifier:i.identifier,drugName:i.name,gender:i.gender,dob:i.birthdate,dispensationDate:i.dispensation_date,packSize:i.pack_sizes[0],packSizes:i.pack_sizes.length,quantity:i.quantity})}this.clients.push(parseInt("".concat(o)))}return this.data}}const x=g({mixins:[m],components:{ReportTemplate:u,IonPage:R},data:()=>({title:"Regimen Report",rows:[],headerList:[],columns:[[r.thTxt("ARV#"),r.thTxt("Gender"),r.thTxt("DOB"),r.thTxt("Drug Name"),r.thTxt("Date"),r.thTxt("Pack size"),r.thTxt("Total pack"),r.thTxt("Total pills")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,s,e=!1){this.rows=[],this.report=new b,this.report.setOccupation(s.occupation),this.report.setRegenerate(e),this.report.setStartDate(s.start_date),this.report.setEndDate(s.end_date),this.period=this.report.getDateIntervalPeriod();const o=await this.report.generateReport();this.setRows(o),this.headerList=[{label:"Total clients",value:this.report.clients.length}]},setRows(t){const s=e=>e?r.tdDate(e):r.td("N/A");this.rows=this.sortByArvNumber(t,"identifier").map(e=>[this.tdARV(e.identifier),r.td(this.formatGender(e.gender)),s(e.dob),r.td(e.drugName),s(e.dispensationDate),r.td(e.packSize),r.td(e.packSizes),r.td(e.quantity)])}}});function S(t,s,e,o,n,i){const d=p("report-template"),h=p("ion-page");return T(),w(h,null,{default:D(()=>[k(d,{reportPrefix:"MoH",title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,hasServerSideCaching:!0,headerInfoList:t.headerList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","headerInfoList","onReportConfiguration"])]),_:1})}const B=_(x,[["render",S]]);export{B as default};
