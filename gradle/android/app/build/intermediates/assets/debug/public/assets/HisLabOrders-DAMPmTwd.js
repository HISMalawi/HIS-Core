import{d as S,bp as k,s as $,J as l,ct as d,S as m,E as p,D as C,X as B,aj as F,A as T,B as h,o as a,c as x,w as _,h as t,f as c,F as f,g,a as E,e as y,t as o,aa as H,ab as I,ac as A}from"./index-CmAu9cV_.js";import{L}from"./LabOrderModal-BSL2eUpN.js";import{_ as N}from"./FieldMixin.vue_vue_type_script_lang-Bb13pIN4.js";import"./lab_order_service-byBo3ZA4.js";const P=S({components:{ViewPort:k,IonButton:$},mixins:[N],data:()=>({HisDate:l,rows:[],fetchingOrders:!1,ordersToday:{}}),methods:{async init(){this.$emit("onFieldActivated",this),this.fetchingOrders=!0;let s=[];try{s=await this.options(this.fdata)}catch(e){console.error("".concat(e))}this.fetchingOrders=!1;const r=s[0].other.values;this.ordersToday=r.reduce((e,i)=>(d(i.ordered)===d(m.getSessionDate())&&!i.result.length&&(e[i.test_name]=!0),e),{}),this.rows=r.map(e=>(e.id=e.order_id,e.ordered&&(e.ordered=l.toStandardHisDisplayFormat(e.ordered)),e.released&&(e.released=l.toStandardHisDisplayFormat(e.released)),e))},async printOrder(s){var r;if(d(s.ordered)!=d(m.getSessionDate()))return p("Printing order #".concat(s.accession_number," is restricted to today. Consider using BDE mode/set session date to the order date"));typeof((r=this.config)==null?void 0:r.printOrder)=="function"&&await C("Do you want to print order with accession number ".concat(s.accession_number,"?"))&&this.config.printOrder(s.id)},formatOrders(s){return s.map(r=>({id:r.order_id,encounter_id:r.encounter_id,result_given:r.result_given,accession_number:r.accession_number,test_name:r.tests[0].name,specimen:r.specimen.name,ordered:l.toStandardHisDisplayFormat(r.order_date),result:[],release:""}))},async launchOrderSelection(s=null){if(this.fetchingOrders)return p("Please wait....");const r=await B.create({component:L,backdropDismiss:!1,cssClass:"large-modal",componentProps:{testFilters:s,ordersToday:this.ordersToday,onOrderAdded:i=>this.ordersToday[i]=!0}});r.present();const{data:e}=await r.onDidDismiss();F.isEmpty(e)||(this.rows=[...this.formatOrders(e),...this.rows])}},mounted(){this.init()},activated(){this.init()}}),w=s=>(I("data-v-c8e35324"),s=s(),A(),s),V={class:"view-port-content"},R={class:"his-sm-text"},j=w(()=>t("tr",null,[t("th",null,"Accession #"),t("th",null,"Test Name"),t("th",null,"Specimen"),t("th",null,"Ordered"),t("th",null,"Result"),t("th",null,"Released"),t("th",null,"Given")],-1)),z=w(()=>t("br",null,null,-1));function G(s,r,e,i,J,M){const v=h("ion-button"),b=h("view-port");return a(),x(b,null,{default:_(()=>[t("div",V,[t("table",R,[j,(a(!0),c(f,null,g(s.rows,(n,O)=>(a(),c("tr",{key:O},[t("td",null,[E(v,{color:"light",fill:"none",onClick:u=>s.printOrder(n)},{default:_(()=>[y(o(n.accession_number),1)]),_:2},1032,["onClick"])]),t("td",null,o(n.test_name),1),t("td",null,o(n.specimen),1),t("td",null,o(n.ordered),1),t("td",null,[(a(!0),c(f,null,g(n.result,(u,D)=>(a(),c("span",{key:D},[y(o(u)+" ",1),z]))),128))]),t("td",null,o(n.released),1),t("td",null,[t("span",{style:H("color: ".concat(n.result_given==="Yes"?"green;":"black;"))},o(n.result_given),5)])]))),128))])])]),_:1})}const K=T(P,[["render",G],["__scopeId","data-v-c8e35324"]]);export{K as default};
