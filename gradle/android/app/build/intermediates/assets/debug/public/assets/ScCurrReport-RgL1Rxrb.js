import{d,x as f,ch as D,Q as c,W as v,ah as _,cA as m,X as b,E as C,K as P,A as h,B as u,o as R,c as S,w,a as g}from"./index-CmAu9cV_.js";import{v as y}from"./TableView-Bzp4sqn4.js";import{S as A}from"./stock_report_service-BCa3SfFr.js";import{D as k}from"./ReportDateSelectionPrompt-CxOATCCt.js";import{D as I}from"./DrillTableModal-BE_SpYCz.js";import"./Export-DV3j_OQc.js";const $=d({components:{IonPage:f,IonLoading:D,v2Datatable:y},setup(){const e=c([]),i=c(""),n=c(!1),t=new A,p=[[{label:"#",ref:"index"},{label:"ARV drug category",ref:"category"},{label:"# of bottles (units) remaining",ref:"units",value:o=>m(o.units),tdClick:async o=>{(await b.create({component:I,cssClass:"custom-modal",componentProps:{title:o.data.category,columns:["Drug","Quantity"],onRows:()=>{var a;return(((a=o.data)==null?void 0:a.granular_spec)||[]).map(s=>[s.drug_name,m(s.units)])}}})).present()}}]],l=async()=>{if(!(t.startDate&&t.endDate))return C("Start date and end date required!");n.value=!0,e.value=[];try{e.value=(await t.getScCurrReport()).map((o,a)=>({...o,index:a+1}))}catch(o){P("Unable to generate report!")}n.value=!1},r=()=>k({onFinish:(o,a,s)=>{i.value=s,t.startDate=o,t.endDate=a,l()}});return v(()=>!e.value.length&&r()),{Img:_,reportData:e,isLoading:n,configure:r,generate:l,columns:p,period:i}}});function B(e,i,n,t,p,l){const r=u("ion-loading"),o=u("v2Datatable"),a=u("ion-page");return R(),S(a,null,{default:w(()=>[g(r,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),g(o,{title:"Sc Curr","icon-url":e.Img("login-logos/PEPFAR.png"),subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:20,onConfigure:e.configure,onRefresh:()=>e.generate(),reportPrefix:"PEPFAR"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const W=h($,[["render",B]]);export{W as default};
