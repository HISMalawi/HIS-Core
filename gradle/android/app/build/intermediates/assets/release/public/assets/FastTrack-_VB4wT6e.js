import{F as a}from"./dynamic-import-helper-9HnG3Mif.js";import{H as l}from"./HisStandardForm-NL7Pv0Lm.js";import{b2 as n,d as u,t as o,T as d,V as i,_ as p,r as f,o as h,c as m}from"./index-ru8RXlaa.js";import{_ as v}from"./EncounterMixin.vue_vue_type_script_lang-SPERpwts.js";import"./TouchScreenForm-QVpoxsVO.js";import"./ToolbarMediumCard-Mlzu3SIO.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-LUNlto_Q.js";import"./encounter_guidelines-o2Ohhd7F.js";import"./GuidelineEngine-syyQoOzo.js";class _ extends n{constructor(s,e){super(s,156,e)}getAssessmentValues(){return n.getConceptsByCategory("fast_track")}}const b=u({mixins:[v],components:{HisStandardForm:l},data:()=>({fields:[],fastTrack:{},options:[],values:[],gender:null}),watch:{ready:{async handler(t){t&&this.init(this.patient)},immediate:!0}},methods:{async onFinish(t){if(await this.fastTrack.createEncounter()){const e=await this.buildObs(t);if(!await this.fastTrack.saveObservationList(e))return o("Unable to save patient observations");d("Observations and encounter created!"),this.nextTask()}else return o("Unable to create fast track encounter")},async init(t){this.gender=t.getGender(),this.fastTrack=new _(t.getID(),this.providerID),this.values=await this.getYesNo(),this.options=await this.getOptions(),this.fields=this.getFields()},async buildObs(t){const s=[];return s.push(await this.fastTrack.buildValueCoded("Assess for fast track",t.ft_assessment.value)),t.ft_questions&&(await t.ft_questions.forEach(async e=>{s.push(await this.fastTrack.buildValueCoded(e.label,e.value))}),s.push(await this.fastTrack.buildValueCoded("Fast track",t.book_client.value))),s},async getOptions(){const t=this.getYesNo(),s=await this.fastTrack.getAssessmentValues("fast_track").map(e=>({label:e.name,value:"",other:{values:t}}));return this.gender==="M"?s.filter(e=>!e.label.match(/Pregnant/i)):s},getYesNo(){return[{label:"yes",value:"Yes"},{label:"no",value:"No"}]},getFields(){return[{id:"ft_assessment",helpText:"Assess client for FT",type:a.TT_SELECT,validation:t=>i.required(t),options:()=>this.getYesNo()},{id:"ft_questions",helpText:"Assess client for FT",type:a.TT_MULTIPLE_YES_NO,condition(t){return t.ft_assessment.value==="Yes"},validation:t=>i.anyEmpty(t),options:()=>this.options},{id:"book_client",helpText:"Select type of visit to book",type:a.TT_SELECT,condition(t){return t.ft_assessment.value==="Yes"},validation:t=>i.required(t),options:()=>[{label:"Fast track",value:"No"},{label:"Normal visit",value:"No"}]}]}}});function T(t,s,e,r,k,g){const c=f("his-standard-form");return h(),m(c,{fields:t.fields,onFinishAction:t.onFinish,skipSummary:!0,cancelDestinationPath:t.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}const V=p(b,[["render",T]]);export{V as default};
