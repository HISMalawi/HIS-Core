System.register(["./opd_report_service-legacy-NtyImQjv.js","./BaseTableReport-legacy-aDH7ZYlV.js","./index-legacy-Ezw3ESUe.js","./ReportMixin.vue_vue_type_script_lang-legacy-_kY6SfD2.js","./overlays-9d7511dd-legacy-YOedm6aG.js","./Export-legacy-0q9fKi6l.js","./HisStandardForm-legacy-xovrdhbF.js","./TouchScreenForm-legacy--Rf9oyT4.js","./dynamic-import-helper-legacy-BhGHTWZn.js","./ToolbarMediumCard-legacy-_H0PbO4B.js","./Transformers-legacy-PbfCTy2a.js","./ViewPort-legacy-vAtaXxEN.js","./BasicReportTemplate-legacy-HGFAlSUY.js","./SIngleTouchField-legacy-bp3msIa4.js","./Pagination-legacy-1JH6Libl.js","./MultiFieldDateHelper-legacy-N4b6PyTj.js","./KbLayouts-legacy-NQmKRJpJ.js","./HisKbConfigurations-legacy-AV_G95Cg.js"],(function(t,e){"use strict";var l,i,n,a,s,r,o,u,d,c,g,p,y,h,f,m,_,v,w,R,j;return{setters:[t=>{l=t.O},t=>{i=t.R},t=>{n=t.d,a=t._,s=t.r,r=t.o,o=t.x,u=t.b,d=t.w,c=t.u,g=t.F,p=t.v,y=t.c,h=t.y,f=t.A,m=t.I,_=t.L,v=t.H,w=t.S},t=>{R=t._},t=>{j=t.m},null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=n({props:{list:Object},setup:()=>({closeModal:async()=>await j.dismiss()})}),b=f("h3",null,"Type of Visit",-1),D=f("h3",null," < 5yrs ",-1),B=f("h3",null," > 5yrs",-1),T=f("h3",null,"Total",-1),x=a(e,[["render",function(t,e,l,i,n,a){const f=s("ion-title"),m=s("ion-button"),_=s("ion-toolbar"),v=s("ion-header"),w=s("ion-col"),R=s("ion-row"),j=s("ion-item"),x=s("ion-list"),C=s("ion-grid"),S=s("ion-content");return r(),o(g,null,[u(v,null,{default:d((()=>[u(_,null,{default:d((()=>[u(f,null,{default:d((()=>[c("Clinic Registration Report Summary")])),_:1}),u(m,{color:"danger",slot:"end",onClick:e[0]||(e[0]=e=>t.closeModal())},{default:d((()=>[c("X")])),_:1})])),_:1})])),_:1}),u(S,{class:"ion-padding"},{default:d((()=>[u(C,null,{default:d((()=>[u(R,null,{default:d((()=>[u(w,null,{default:d((()=>[b])),_:1}),u(w,null,{default:d((()=>[D])),_:1}),u(w,null,{default:d((()=>[B])),_:1}),u(w,null,{default:d((()=>[T])),_:1})])),_:1}),u(x,null,{default:d((()=>[(r(!0),o(g,null,h(t.list,(t=>(r(),y(j,{key:t},{default:d((()=>[u(w,null,{default:d((()=>[c(p(t.label),1)])),_:2},1024),u(w,null,{default:d((()=>[c(p(t.under5),1)])),_:2},1024),u(w,null,{default:d((()=>[c(p(t.over5),1)])),_:2},1024),u(w,null,{default:d((()=>[c(p(t.value),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)}]]),C=n({components:{ReportTemplate:i,IonPage:m},mixins:[R],data:()=>({title:"Clinic Registration",rows:[],reportData:[],columns:[[_.thTxt("Reg"),_.thTxt("First Name"),_.thTxt("Last Name"),_.thTxt("Gender"),_.thTxt("DOB"),_.thTxt("Date reg.")]],customBtns:[]}),created(){this.fields=this.getDateDurationFields(),this.customBtns.push({name:"High level view",size:"large",slot:"start",color:"primary",visible:!0,onClick:async()=>this.showModal()})},methods:{async init(t,e){const i=new l;i.setStartDate(e.start_date),i.setEndDate(e.end_date),this.period=i.getDateIntervalPeriod();const n=await i.getClinicRegistrations();this.reportData=n.sort(((t,e)=>t.visit_type>e.visit_type?1:t.visit_type<e.visit_type?-1:0)),this.rows=this.buildRows(this.reportData)},buildRows:t=>t.length?t.map((t=>[_.td(t.visit_type),_.td(t.given_name),_.td(t.family_name),_.td(t.gender),_.td(v.toStandardHisDisplayFormat(t.birthdate)),_.td(v.toStandardHisDisplayFormat(t.visit_date))])):[],filterBy(t,e){return this.reportData.filter((l=>{const i=v.calculateAge(l.birthdate,w.getSessionDate());return l.visit_type===t&&("under5"===e?i<=5:i>6)}))},modalData(){const t=[...this.filterBy("New patient","under5")].length,e=[...this.filterBy("New patient","over5")].length,l=t+e,i=[...this.filterBy("Referral","under5")].length,n=[...this.filterBy("Referral","over5")].length,a=i+n,s=[...this.filterBy("Revisiting","under5")].length,r=[...this.filterBy("Revisiting","over5")].length;return[{label:"New patient",under5:t,over5:e,value:l},{label:"Referral",under5:i,over5:n,value:a},{label:"Revisiting",under5:s,over5:r,value:s+r}]},async showModal(){const t=[...this.modalData()];(await j.create({component:x,backdropDismiss:!0,cssClass:"action-sheet-modal",componentProps:{list:t}})).present()}}});t("default",a(C,[["render",function(t,e,l,i,n,a){const o=s("report-template"),c=s("ion-page");return r(),y(c,null,{default:d((()=>[u(o,{title:t.title,rows:t.rows,fields:t.fields,columns:t.columns,itemsPerPage:10,period:t.period,reportPrefix:"Clinic",onReportConfiguration:t.init,customBtns:t.customBtns,paginated:""},null,8,["title","rows","fields","columns","period","onReportConfiguration","customBtns"])])),_:1})}]]))}}}));
