System.register(["./ViewPort-legacy-vAtaXxEN.js","./FieldMixin.vue_vue_type_script_lang-legacy-Cu6Twhoz.js","./index-legacy-Ezw3ESUe.js","./dynamic-import-helper-legacy-BhGHTWZn.js","./BaseTextInput-legacy-RTd4t7TO.js","./PopupKeyboard-legacy-imgIayl9.js","./SIngleTouchField-legacy-bp3msIa4.js","./TouchScreenForm-legacy--Rf9oyT4.js","./ToolbarMediumCard-legacy-_H0PbO4B.js","./Transformers-legacy-PbfCTy2a.js","./HisKeypad-legacy-0bnWVuIO.js","./BaseKeyboard-legacy-kBi1RnEG.js","./KbLayouts-legacy-NQmKRJpJ.js","./KbHandler-legacy-YpKYWvgQ.js","./overlays-9d7511dd-legacy-YOedm6aG.js"],(function(e,t){"use strict";var l,s,a,i,u,n,r,o,d,c,g,h,y,p,f,m,b,v,_,D,T,j,V,k,x,I,w;return{setters:[e=>{l=e.V},e=>{s=e._},e=>{a=e.d,i=e.ai,u=e.g,n=e.ak,r=e.aj,o=e.h,d=e.C,c=e.b8,g=e.ck,h=e.V,y=e._,p=e.r,f=e.o,m=e.c,b=e.w,v=e.b,_=e.F,D=e.v,T=e.u,j=e.y,V=e.x,k=e.z},e=>{x=e.F},e=>{I=e.default},e=>{w=e.P},null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent="ion-label[data-v-e0a43b00]{font-weight:700}.border-right[data-v-e0a43b00]{border-right:solid 1px #ccc}.scroll-list[data-v-e0a43b00]{height:70vh;overflow:auto}.input_display[data-v-e0a43b00]{font-size:1.3em}\n",document.head.appendChild(t);const C=a({components:{ViewPort:l,IonGrid:i,IonList:u,IonCol:n,IonRow:r,IonItem:o,IonLabel:d,IonInput:c,HisTextInput:I},mixins:[s],data:()=>({drugs:[],selectedDrug:null}),async activated(){this.init()},methods:{async init(){this.$emit("onFieldActivated",this),this.drugs=await this.options(),this.drugs.length>=1&&this.selectDrug(0)},fmtNumber:e=>g(e),getModalTitle(e){return`${e} (${this.drugs[this.selectedDrug].label})`},getDrugValue(e){return this.drugs[this.selectedDrug].other[e]},setDrugValue(e,t){this.drugs[this.selectedDrug].other[e]=t?t.value:""},enterTins(){w({id:"tins",helpText:this.getModalTitle("Enter number of tins"),type:x.TT_NUMBER,defaultValue:()=>this.getDrugValue("tins"),validation:e=>!e||e&&!e.value?null:h.validateSeries([()=>h.isNumber(e),()=>e.value<=0?["Number of tins must be greater than 1"]:null,()=>e.value>this.getDrugValue("quantity")?["You cannot dispose/relocate more than available tins"]:null])},(e=>this.setDrugValue("tins",e)))},async selectReason(){const e=this.getDrugValue("batch_number");w({id:"reason",helpText:this.getModalTitle(`Select reason for disposing/relocating Batch ${e}`),type:x.TT_SELECT,defaultValue:()=>this.getDrugValue("reason"),validation:e=>h.required(e),options:()=>this.config?.getReasons(this.drugs[this.selectedDrug],this.fdata)||[]},(e=>{this.setDrugValue("reason",e)}))},selectDrug(e){this.selectedDrug=e}},computed:{fullSelectedDrugName(){try{const[e,t,,l]=this.drugs[this.selectedDrug]?.description?.text.split("-")??"";return`${this.drugs[this.selectedDrug].label} (${e}-${t}-${l})`}catch(e){return"N/A"}},updatedDrugs(){return this.drugs.filter((e=>!!e.other?.tins&&!!e.other?.reason))}},watch:{clear(){this.drugs=this.drugs.map((e=>(e.other={...e.other,tins:null,quantity:e.current_quantity/e.pack_size||1,reason:""},e)))},drugs:{async handler(){this.$emit("onValue",this.updatedDrugs)},immediate:!0,deep:!0}}});e("default",y(C,[["render",function(e,t,l,s,a,i){const u=p("his-text-input"),n=p("ion-item"),r=p("ion-list"),o=p("ion-col"),d=p("ion-label"),c=p("ion-input"),g=p("ion-row"),h=p("ion-grid"),y=p("view-port");return f(),m(y,null,{default:b((()=>[v(u,{readonly:"",value:e.fullSelectedDrugName},null,8,["value"]),v(h,{style:{background:"white"}},{default:b((()=>[v(g,null,{default:b((()=>[v(o,{size:"4",class:"border-right scroll-list"},{default:b((()=>[(f(!0),V(_,null,j(e.drugs,((t,l)=>(f(),m(r,{key:l},{default:b((()=>[v(n,{detail:"",color:l===e.selectedDrug?"secondary":"",onClick:t=>e.selectDrug(l)},{default:b((()=>[T(D(t.label),1)])),_:2},1032,["color","onClick"])])),_:2},1024)))),128))])),_:1}),v(o,null,{default:b((()=>[null!==e.selectedDrug?(f(),m(h,{key:0,class:"scroll-list"},{default:b((()=>[v(g,null,{default:b((()=>[v(o,{size:"12",class:"ion-margin-bottom"},{default:b((()=>[v(n,null,{default:b((()=>[v(d,{position:"floating"},{default:b((()=>[T("Available Tins/Pallets (pack size: "+D(e.drugs[e.selectedDrug].other?.pack_size)+"):",1)])),_:1}),v(c,{readonly:"",disabled:"",value:e.fmtNumber(e.drugs[e.selectedDrug].other?.quantity)},null,8,["value"])])),_:1})])),_:1}),v(o,{size:"12"},{default:b((()=>[v(n,null,{default:b((()=>[v(d,{position:"floating"},{default:b((()=>[T("Total Tins Relocated/Disposed")])),_:1}),v(c,{readonly:"",color:"primary",value:e.fmtNumber(e.drugs[e.selectedDrug].other?.tins||0),onClick:e.enterTins},null,8,["value","onClick"])])),_:1})])),_:1}),v(o,{size:"12"},{default:b((()=>[v(n,null,{default:b((()=>[v(d,{position:"floating"},{default:b((()=>[T("Reason for Relocating/Disposing")])),_:1}),v(c,{readonly:"",color:"primary",placeholder:"select reason",value:e.drugs[e.selectedDrug].other?.reason||"",onClick:e.selectReason},null,8,["value","onClick"])])),_:1})])),_:1})])),_:1})])),_:1})):k("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-e0a43b00"]]))}}}));
