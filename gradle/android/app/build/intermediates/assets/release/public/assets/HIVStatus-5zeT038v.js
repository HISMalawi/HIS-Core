import{H as y}from"./HisStandardForm-NL7Pv0Lm.js";import{b2 as I,d as H,K as C,V as r,o as R,c as L,w as k,cj as d,b as O,I as U,t as c}from"./index-ru8RXlaa.js";import{F as o}from"./dynamic-import-helper-9HnG3Mif.js";import{g as T}from"./LocationFieldOptions-pw97i4BX.js";import{g as s,E as u}from"./MultiFieldDateHelper-5DHelb14.js";import{u as N}from"./useEncounter-LKpLfobq.js";import{y as m,m as p,r as q}from"./commons-goK0bb08.js";import"./TouchScreenForm-QVpoxsVO.js";import"./ToolbarMediumCard-Mlzu3SIO.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-LUNlto_Q.js";import"./KbLayouts-9dqmDWmG.js";import"./HisKbConfigurations-a7K7dizM.js";import"./isEmpty-Ba1Sj3wK.js";import"./encounter_guidelines-o2Ohhd7F.js";import"./GuidelineEngine-syyQoOzo.js";class l extends I{constructor(a,n){super(a,39,n)}}const ie=H({__name:"HIVStatus",setup(v){let a;const n=C([]),{patientDashboardUrl:_,goToNextTask:f}=N((e,t,i)=>{a=new l(t,e),n.value=[A(),...F(i),x(),E(),g(),...h(i),...S(i),V(),D()]});async function b(e,t){if(!await a.createEncounter())return c("Unable to create encounter");const w=await q({...t});if(!await a.saveObservationList(w))return c("Unable to save observations");f()}function D(){return{id:"advised_to_visit_art",helpText:"Advised to visit ART",type:o.TT_SELECT,options:m,condition:e=>e.received_arvs.value!=="Yes",computedValue:e=>({obs:a.buildValueCoded("Advised to visit ART",e.value)})}}function V(){return{id:"art_clinic_location",helpText:"ART clinic location",type:o.TT_SELECT,computedValue:e=>({obs:a.buildValueText("ART clinic location",e.label)}),validation:e=>r.required(e),condition:e=>/Yes|Defaulter/i.test(e.received_arvs.value),options:(e,t="")=>T(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}}}function h(e){return s({id:"date_started_art",helpText:"Started ART",required:!0,condition:t=>t.received_arvs.value==="Yes",minDate:()=>{var t;return"".concat((t=e==null?void 0:e.getBirthdate())!=null?t:"")},maxDate:()=>a.getDate(),estimation:{allowUnknown:!0,estimationFieldType:u.MONTH_ESTIMATE_FIELD},computeValue:(t,i)=>a.buildDateObs("Date ART started",t,i)})}function S(e){return s({id:"date_defualted_art",helpText:"ART Default",required:!0,condition:t=>t.received_arvs.value==="Defaulter",minDate:()=>{var t;return"".concat((t=e==null?void 0:e.getBirthdate())!=null?t:"")},maxDate:()=>a.getDate(),estimation:{allowUnknown:!0,estimationFieldType:u.MONTH_ESTIMATE_FIELD},computeValue:(t,i)=>a.buildDateObs("ART default date",t,i)})}function E(){return{id:"cpt_started",helpText:"CPT Started",type:o.TT_SELECT,options:m,condition:e=>e.hiv_status.value==="Reactive",computedValue:e=>({obs:a.buildValueCoded("CPT Started",e.value)})}}function g(){return{id:"received_arvs",helpText:"Started ART?",type:o.TT_SELECT,computedValue:({value:e})=>({obs:a.buildValueCoded("ART Started",e)}),validation:e=>r.required(e),options:()=>p(["Yes","No","Defaulter","Unknown"]),condition:e=>e.hiv_status.value==="Reactive"}}function A(){return{id:"hiv_status",helpText:"HIV status",type:o.TT_SELECT,validation:e=>r.required(e),computedValue:e=>({obs:a.buildValueText("HIV status",e.label)}),options:()=>p(["Reactive","Non-reactive","Unknown"])}}function F(e){return s({id:"hiv_test_date",helpText:"HIV Test",required:!0,minDate:()=>{var t;return"".concat((t=e==null?void 0:e.getBirthdate())!=null?t:"")},maxDate:()=>l.getSessionDate(),condition:t=>t.hiv_status.value!=="Unknown",summaryLabel:"HIV test date",estimation:{allowUnknown:!0,estimationFieldType:u.MONTH_ESTIMATE_FIELD},computeValue:(t,i)=>a.buildDateObs("HIV test date",t,i)})}function x(){return{id:"test_location",helpText:"HIV test location",type:o.TT_SELECT,validation:e=>r.required(e),defaultValue:()=>l.getLocationName(),computedValue:({label:e})=>({obs:a.buildValueText("HIV test location",e)}),condition:e=>e.hiv_status.value!=="Unknown",options:(e,t="")=>T(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}}}return(e,t)=>(R(),L(d(U),null,{default:k(()=>[O(y,{cancelDestinationPath:d(_),fields:n.value,onFinishAction:b,skipSummary:""},null,8,["cancelDestinationPath","fields"])]),_:1}))}});export{ie as default};
